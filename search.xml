<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>英语学习</title>
      <link href="/2023/05/13/%E8%8B%B1%E8%AF%AD%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/"/>
      <url>/2023/05/13/%E8%8B%B1%E8%AF%AD%E8%AF%AD%E6%B3%95%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>开始:<a href="https://www.bilibili.com/video/BV1XY411J7aG/?p=2&vd_source=bed2588951fb9fd0821dd2ef0191e48b">https://www.bilibili.com/video/BV1XY411J7aG/?p=2&amp;vd_source=bed2588951fb9fd0821dd2ef0191e48b</a></p><h1 id="英语语法综述"><a href="#英语语法综述" class="headerlink" title="英语语法综述"></a>英语语法综述</h1><p>学习语法就是为了——&gt; 造句</p><h1 id="简单句"><a href="#简单句" class="headerlink" title="简单句"></a>简单句</h1><ul><li>将长句子拆成不能再拆的句子，就称为简单句</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">什么 + 怎么样</span><br><span class="line">(主语subject)(谓语predicate)</span><br><span class="line">什么，怎么样对应了两个基本的句子成分</span><br><span class="line"></span><br><span class="line">而这里的谓语包括了： 动作/发生了什么事</span><br></pre></td></tr></table></figure><ul><li><p>动作(动词)</p><ol><li><p>可以独立完成的动作</p><p>主语 + <em>不及物动词</em> (Papa Rabbit sleeps 兔老爹睡觉)这里sleep就是不及物动词</p></li><li><p>有1个动作的承受者</p><p>主语 + 单及物动词 + 宾语(Papa Rabbit likes you 兔老爹喜欢你)</p></li><li><p>有2个动作承受者</p><p>主语 + 双及物动词 + 间接宾语 + 直接宾语(Papa Rabbit teacher your English)</p></li><li><p>只有1个动作承受者(但需补充)</p><p>主语 + 复杂及物动词 + 宾语 + (宾语)补语(Papa Rabbit considers you smart)</p></li><li><p>非”动作”</p><p>主语 + 系动词 + (主语)补语&#x2F;表语</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">比如：</span><br><span class="line">Beihai looks tall</span><br><span class="line">beihai in the room</span><br><span class="line">Papa Rabbit smells nice</span><br><span class="line"></span><br><span class="line">这里我们称之为： 连系动词   ---- &gt; 系动词</span><br></pre></td></tr></table></figure></li></ol></li><li><p>句子成分</p><ol><li>主语</li><li>谓语动词</li><li>宾语</li><li>宾语补语</li><li>主语补语</li><li>定语</li><li>状语</li><li>同位语</li></ol></li><li><p>简单句的转换</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">名词性从句：</span><br><span class="line">简单句作主语-----&gt; 主语从句</span><br><span class="line">简单句作宾语-----&gt; 宾语从句</span><br><span class="line">简单句作表语-----&gt; 表语从句</span><br><span class="line">简单句作同位语-----&gt; 同位语从句</span><br><span class="line"></span><br><span class="line">非名词性从句：</span><br><span class="line">简单句作定语-----&gt; 定语从句</span><br><span class="line">简单句作状语-----&gt; 状语从句</span><br></pre></td></tr></table></figure></li><li><p>词性</p><ol><li>名词</li><li>冠词</li><li>代词</li><li>形容词</li><li>数词</li><li>副词</li><li>介词</li><li>叹词</li><li>连词</li></ol></li><li><p>谓语动词的“三大本领”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">时体气</span><br><span class="line">1.动作时间</span><br><span class="line">现在过去将来过去将来</span><br><span class="line">2.动作状态</span><br><span class="line">一般完成进行完成进行</span><br><span class="line">3.动作假设，情感</span><br></pre></td></tr></table></figure></li><li><p>助动词</p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230513160908907.png" alt="image-20230513160908907" style="zoom:50%;" /></li><li><p>非谓语动词</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">不充当谓语的动词：</span><br><span class="line">动词不定式</span><br><span class="line">现在分词</span><br><span class="line">动名词</span><br><span class="line">过去分词</span><br></pre></td></tr></table></figure></li></ul><h1 id="动词"><a href="#动词" class="headerlink" title="动词"></a>动词</h1><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230513161552398.png" alt="image-20230513161552398" style="zoom:50%;" /><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230513161623757.png" alt="image-20230513161623757"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">实义动词： 不及物动词 + 及物动词</span><br></pre></td></tr></table></figure><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230513162014026.png" alt="image-20230513162014026"></p><h2 id="动词时间"><a href="#动词时间" class="headerlink" title="动词时间"></a>动词时间</h2><p>过去现在将来</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>git连接github</title>
      <link href="/2023/05/13/git%E8%BF%9E%E6%8E%A5github/"/>
      <url>/2023/05/13/git%E8%BF%9E%E6%8E%A5github/</url>
      
        <content type="html"><![CDATA[<p>最近hexo三连和git push都不能用了，搞了好长时间发现下面几个问题</p><ul><li><p>现在GitHub有些不支持rsa加密，可以使用ed25519</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t 加密类型 -C &quot;你的邮箱&quot;</span><br><span class="line"></span><br><span class="line">ex:</span><br><span class="line">ssh-keygen -t ed25519 -C &quot;1604252677&quot;</span><br></pre></td></tr></table></figure><p>更改完之后我发现如果你来回更换这个加密类型会导致默认的端口22不能用了</p><p><img src="E:\Hexo-Blog\piccode\PicCode\img\git_1.png" alt="image-20230513100301324"></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> 实用小技巧 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>免费图床综合教程</title>
      <link href="/2023/05/11/%E5%85%8D%E8%B4%B9%E5%9B%BE%E5%BA%8A%E7%BB%BC%E5%90%88%E6%95%99%E7%A8%8B/"/>
      <url>/2023/05/11/%E5%85%8D%E8%B4%B9%E5%9B%BE%E5%BA%8A%E7%BB%BC%E5%90%88%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="1-基于Github仓库的图床"><a href="#1-基于Github仓库的图床" class="headerlink" title="1.基于Github仓库的图床"></a>1.基于Github仓库的图床</h2><p><strong>优点：</strong></p><ol><li>很稳定不会跑路，用的是自己的仓库和公共托管平台</li><li>图片可以增量快速更新和跨设备管理</li><li>可以进行版本管理和查看之前的版本</li><li>有公共CDN，速度还是不错的</li><li>资源格式可以任意都行，包括<code>css</code>、<code>js</code>等</li></ol><p><strong>缺点：</strong></p><ol><li>每个仓库限制1G，超过要新建另一个仓库</li><li>git管理可能偶尔会遇到网络和公钥失效问题</li></ol><h3 id="1-1-建立Github仓库"><a href="#1-1-建立Github仓库" class="headerlink" title="1.1 建立Github仓库"></a>1.1 建立Github仓库</h3><ol><li><p>进入<a href="https://github.com/">Github官网</a>注册并登录自己的账号，到自己的个人主页，点击右上角的<code>+</code>，并选择<code>New Repository</code>创建自己的仓库。</p></li><li><p>仓库名字随意，描述也可以自由发挥，可见性最好选<code>public</code>，<code>Readme</code>文件可以创建，然后点击<code>Create Repository</code>创建仓库。</p></li><li><p>让你的计算机与Github建立通信，主要是<code>创建公钥</code>、<code>上传公钥</code>、<code>检查通信</code>这几步，确保计算机有权限访问远程仓库，所述教程是用的<code>RSA公钥</code>，目前更推荐<code>ed25519公钥</code>，该数字签名算法的签名和验证的性能都极⾼，具体教程百度这里不再赘述。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t 加密算法 -C &quot;邮箱&quot;</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/638b237216f2c2beb1ce8b7e.jpg" alt="img"></p></li><li><p>先在本地创建一个文件夹，文件夹位置和名字随意就可以，进入该文件夹后右键打开<code>Git Bash</code>，然后输入以下代码把之前创建的仓库拷贝下来，其中<code>git clone</code>后面的东西要替换成自己的仓库信息，可以通过自己仓库的ssh链接来获取。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line">git clone git@github.com:Bei-Hai/pic_bed.git</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/638b260716f2c2beb1d21741.jpg" alt="img"></p><p>看到上图的信息就代表成功把整个仓库拷贝到当前文件夹了，此时我们可以看见自己的文件夹多了个<code>.git</code>文件夹和<code>Readme.md</code>文件，这就代表成功了。</p><p><img src="https://pic.imgdb.cn/item/638b26f516f2c2beb1d324a9.jpg" alt="img"></p></li><li><p>此时我们最好在这个文件夹里面创建创建一个<code>img</code>文件夹专门存放图片，如果有存放其他类型资源的可以创建别的文件夹，比如现在想往仓库里加两张图，直接就把图片复制到<code>img</code>文件夹里面即可。</p><p><img src="https://pic.imgdb.cn/item/638b277216f2c2beb1d3ba52.jpg" alt="img"></p><p>然后在带有<code>Readme.md</code>文件的那个文件夹内，右键打开<code>Git Bash</code>（注意看清楚是什么文件夹），然后依次输入以下命令把更改推送到远程仓库，最后一步不成功可能要多试几次。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line"># 将更改提交</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;更新图片&quot;</span><br><span class="line"># 推送至github仓库</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p>最后看见如下信息就代表推送成功了</p><p><a href="https://pic.imgdb.cn/item/638b28bf16f2c2beb1d5b49b.jpg"><img src="https://pic.imgdb.cn/item/638b28bf16f2c2beb1d5b49b.jpg" alt="img"></a>仓库此时应该也有了刚刚上传的资源了</p><p>下次增删图片或者其他东西，就这样照猫画虎就可以推上来更新仓库！</p></li></ol><h3 id="1-2-Staticaly-CDN加速"><a href="#1-2-Staticaly-CDN加速" class="headerlink" title="1.2 Staticaly CDN加速"></a>1.2 Staticaly CDN加速</h3><p>直接访问Github仓库的资源是非常慢的！因此我们要用一些免费的CDN进行加速，<code>Staticaly CDN</code>是目前免费CDN中比较好用的啦，他的应用规则如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PLAINTEXT</span><br><span class="line"># 格式 其中 user是用户名  repo是仓库名  version代表版本(tag或者分支 默认为main)  flie是文件路径 </span><br><span class="line">https://cdn.staticaly.com/gh/user/repo@version/file</span><br><span class="line"></span><br><span class="line"># 比如我的示例仓库就是加速地址就是这个大家可以参考参考</span><br><span class="line">https://cdn.staticaly.com/gh/BeiHai-Blog/PicCode@main/img/dm14.webp</span><br></pre></td></tr></table></figure><h3 id="1-3-Vercel-部署"><a href="#1-3-Vercel-部署" class="headerlink" title="1.3 Vercel 部署"></a>1.3 Vercel 部署</h3><p>此方法加载速度较快，但是需要域名自定义绑定，其优点也是可以绑定自定义域了，目前Vercel每个月限制流量100GB</p><ol><li><p>进入<a href="https://vercel.com/dashboard">Vercel控制面板</a>新建项目，并<code>通过Github继续</code>，选择导入刚刚创建的仓库，然后直接部署即可</p></li><li><p>进入该项目控制台后，选择右上角的<code>View Domains</code>添加新的域名，添加一个自己域名的二级域名，然后在你对应的域名解析控制台添加对应解析，等待生效。</p></li><li><p>通过<code>自定义域名+资源路径</code>即可访问到对应的资源，例如我这里为<code>https://beihaibei.eu.org/img/dm14.webp</code></p></li><li><p>要更新图片怎么办？只要将资源复制到对应的文件夹，然后再执行一次下面的命令即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BASH</span><br><span class="line"># 将更改提交</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;更新图片&quot;</span><br><span class="line"># 推送至github仓库</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p>这个命令默认是更新到仓库的<code>main</code>分支上，Vercel一旦检测到main分支发送变化就会触发新一轮部署，我们稍候片刻即可通过新的路径访问到新的资源。</p></li></ol><h2 id="2-免费图床推荐"><a href="#2-免费图床推荐" class="headerlink" title="2.免费图床推荐"></a>2.免费图床推荐</h2><ol><li>这部分免费图床就太多了，我会把我目前发现的可以免费白嫖一定额度的图床做一个总结列在下面</li><li>这部分图床的搭建门槛较低，所以速度和稳定性良莠不齐，大家自行选择使用哪个</li><li>我这里只给大家演示一种的使用方法，其他图床使用方法也类似</li><li>大家可以看看哪个比较好用的或者自己知道的好用的这里没有，可以留言我会进行补充</li></ol><table><thead><tr><th align="center">🍕</th><th align="center">🥗</th><th align="center">🍤</th></tr></thead><tbody><tr><td align="center"><a href="https://smms.app/">SMMS</a></td><td align="center"><a href="https://www.superbed.cn/">聚合图床</a></td><td align="center"><a href="https://www.hualigs.cn/">遇见图床</a></td></tr><tr><td align="center"><a href="https://postimages.org/">PostImage</a></td><td align="center"><a href="https://imgse.com/">路过图床</a></td><td align="center"><a href="https://www.imgurl.org/">imgURL</a></td></tr><tr><td align="center"><a href="https://imgbox.com/">imgbox</a></td><td align="center"><a href="https://pic.iqy.ink/upload">Lsky Pro</a></td><td align="center"><a href="https://upload.cc/">Upload.cc</a></td></tr><tr><td align="center"><a href="https://imagelol.com/">imagelol</a></td><td align="center"><a href="https://imgtp.com/">imgtp</a></td><td align="center"><a href="https://cloudimge.com/">云图床</a></td></tr><tr><td align="center"><a href="https://mcecy.com/">载涂图床</a></td><td align="center"><a href="https://tuchuang.voooe.cn/">Sky Chart Bed</a></td><td align="center"><a href="https://www.imgbed.link/">风筝图床</a></td></tr><tr><td align="center"><a href="https://pz.al/">喷子图床</a></td><td align="center"><a href="https://imgkb.com/">imgkb</a></td><td align="center"></td></tr></tbody></table><ul><li>使用方法：直接进入官网，上传图片然后粘贴地址即可，地址的样式有多样，自行选择。</li><li>选择要点：<ol><li>速度：大家可以到<a href="https://ping.cn/">Ping.cn</a>进行测试</li><li>稳定性与安全性：看看图床创建时间，网上评价等</li><li>可适用性：支持的格式越多肯定是越好的，有部分支持<code>webp</code>和其他格式的，可以当资源床</li></ol></li></ul><h2 id="3-PicGo结合Markdown实时上传图片"><a href="#3-PicGo结合Markdown实时上传图片" class="headerlink" title="3.PicGo结合Markdown实时上传图片"></a>3.PicGo结合Markdown实时上传图片</h2><ul><li><p>Picgo究竟是什么？这是一个开源软件，开源地址：<a href="https://github.com/Molunerfinn/PicGo">Molunerfinn&#x2F;PicGo</a></p></li><li><p>引用项目的介绍：这是一个用于快速上传图片并获取图片 URL 链接的工具，关键是他可以与Typora配套一起使用，在粘贴图片的同时上传图片，十分方便！</p></li><li><p>最新版我这里实测没办法安装一些插件，因此推荐大家安装<a href="https://github.com/Molunerfinn/PicGo/releases/tag/v2.3.1-beta.5">v2.3.1-beta.5</a>这个版本</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></p></li><li><p>下载软件后直接一路安装下去就行，建议装在非C盘的任意一个盘。</p></li></ul><h3 id="3-1-Github图床"><a href="#3-1-Github图床" class="headerlink" title="3.1 Github图床"></a>3.1 Github图床</h3><ol><li><p>进入软件之后，一路到设置里面取消勾选其他图床，只留下Github图床一项，因为我们的现在要弄Github图床。</p></li><li><p>然后到Github新建一个仓库，创建仓库的教程前面有讲，这里就不赘述了，<code>仓库名字</code>和<code>描述</code>随意，最重要的是权限一定要选<code>public</code>，这样你的图片才可以随时随地访问到。在图床设置的Github配置处，按照下图填入对应的信息：</p><p>自定义域名的格式为：<code>https://cdn.staticaly.com/gh/用户名/仓库名@main</code>，比如我的就是<code>https://cdn.staticaly.com/gh/fomalhaut1998/markdown_pic@main</code>，对应的<code>用户名</code>和<code>仓库名</code>记住要换成自己名字，不能有空格！！！</p><p>Token的获取方式为：<code>右上角头像</code>-&gt;<code>Setting</code>-&gt;<code>左边栏Developer Settings</code>-&gt;<code>左栏Personal access tokens</code>-&gt;<code>左栏tokens(classic)</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></p><p>创建Token时，<code>Note</code>随意；<code>Exporation</code>选<code>No expiration</code>，<code>Select scopes</code>必须把<code>repo</code>这一项勾上，然后点击生成就行</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></p><p>这个时候必须马上复制出现的token，不然后面就看不到了，复制了填进去刚刚的Token选项，随后点击确定保存</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></p></li><li><p>随便拖拽一张图片进来上传区域这里，应该就可以上传成功，随后把生成的链接复制就可以，此时打开仓库可以发现图片上传到了指定的文件夹。注意：每个仓库大小限制是1G！！！</p></li></ol><p><a href="https://tuchuang.voooe.cn/images/2022/12/30/image-6.webp"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></a></p><h3 id="3-2-Vika图床"><a href="#3-2-Vika图床" class="headerlink" title="3.2 Vika图床"></a>3.2 Vika图床</h3><p>Vika图床的服务器在国内，速度是比较快的</p><ol><li><p>首先在Picgo里面安装Vikadata的插件</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></p></li><li><p>我们要填的信息有下面这几项：</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></p></li><li><p>进入<a href="https://vika.cn/">维格表官网</a>，注册自己的账号并登录，新建一个空白的维格表</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="img"></p></li><li><p>随后点击左下角头像的个人设置，绑定自己的邮箱后，获取<code>API Token</code></p><p><img src="https://tuchuang.voooe.cn/images/2022/12/30/1672392200842.webp" alt="img"></p></li><li><p>进入刚刚创建的表格后，点击上边的<code>API</code>，进入API界面后，依次点击<code>显示API Token</code>-&gt;<code>Get 获取</code>，然后图中框起来的就是我们需要的<code>维格表ID</code>和<code>API Token</code></p><p><img src="https://tuchuang.voooe.cn/images/2022/12/30/1672392201560.webp" alt="img"></p><p><img src="https://tuchuang.voooe.cn/images/2022/12/30/1672392249317.webp" alt="img"></p></li><li><p>填进去对应位置后，到上传区域，把图床换成维格表，试试拖拽图片能不能上传！</p></li></ol><h3 id="3-3-Bilibili图床"><a href="#3-3-Bilibili图床" class="headerlink" title="3.3 Bilibili图床"></a>3.3 Bilibili图床</h3><ul><li>由于这个图床用在博客里存在跨域问题，因此不再推荐使用了，开源地址：<a href="https://github.com/xlzy520/typora-plugin-bilibili">typora-plugin-bilibili</a></li></ul><h3 id="3-4-imgtp图床"><a href="#3-4-imgtp图床" class="headerlink" title="3.4 imgtp图床"></a>3.4 imgtp图床</h3><ul><li>开源地址：<a href="https://github.com/Redns/picgo-plugin-imgtp">picgo-plugin-imgtp</a></li></ul><ol><li><p>在Picg插件商店搜索并安装该插件</p><p><img src="https://tuchuang.voooe.cn/images/2022/12/30/image-8.webp" alt="img"></p></li><li><p>进入<a href="https://imgtp.com/">imgtp</a>注册并登录自己的账号，记住账号密码，待会儿要用到</p></li><li><p>进入控制台，然后进入<code>设置</code>，就可以看到右边有<code>Token</code>这一项，这些就是我们要的全部信息</p><p><img src="https://tuchuang.voooe.cn/images/2022/12/30/image-9.webp" alt="img"></p></li><li><p>随后在imgtp的配置信息里面填上<code>账号</code>、<code>密码</code>、<code>Token</code>这几项即可</p></li><li><p>填进去对应位置后，到上传区域，把图床换成维格表，试试拖拽图片能不能上传！</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> 博客魔改教程 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>钉钉下载直播回放</title>
      <link href="/2023/05/05/%E9%92%89%E9%92%89/"/>
      <url>/2023/05/05/%E9%92%89%E9%92%89/</url>
      
        <content type="html"><![CDATA[<h2 id="手机抓包-电脑下载"><a href="#手机抓包-电脑下载" class="headerlink" title="手机抓包+电脑下载"></a>手机<a href="https://so.csdn.net/so/search?q=%E6%8A%93%E5%8C%85&spm=1001.2101.3001.7020">抓包</a>+电脑下载</h2><h2 id="手机抓包"><a href="#手机抓包" class="headerlink" title="手机抓包"></a>手机抓包</h2><p><a href="https://link.jscdn.cn/1drv/aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBaFAtdlNZTXZHRUpoUXBjaFdJRVZQdTB5V1h0P2U9V09IdlUz.apk">下载链接</a></p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h5 id="一、配置软件"><a href="#一、配置软件" class="headerlink" title="一、配置软件"></a>一、配置软件</h5><ul><li>下载app后安装</li><li>打开软件</li><li>弹出如此界面，点击<strong>界面空白处或者按返回键</strong>关闭对话框</li><li>弹出如此对话框，点击<strong>暂不</strong></li><li>弹出建立请求，点击<strong>确定</strong>（不同手机的界面不一样，我以MIUI为例，道理都差不多，点确定完事了）</li></ul><h5 id="二、开始抓包"><a href="#二、开始抓包" class="headerlink" title="二、开始抓包"></a>二、开始抓包</h5><ul><li>然后返回桌面，<strong>打开钉钉</strong></li><li>打开群中的<strong>直播回放</strong></li><li>点进去你想下载的直播，等到有画面出来了，就可以返回了。（可以重复执行操作，点击多个要下载的直播）<br> PS：你也许可以看到右下角有一个窗口一直蹦着链接，那些就是抓包抓到的地址，不用管它就行</li></ul><h5 id="三、提取出链接，发送给电脑"><a href="#三、提取出链接，发送给电脑" class="headerlink" title="三、提取出链接，发送给电脑"></a>三、提取出链接，发送给电脑</h5><ul><li>然后返回HttpCanary，再次点击右下角的小飞机关闭抓包，小飞机就变成回蓝色了，你说神奇不。（不放图了，我相信你知道是什么）</li><li>然后点击右上角<strong>放大镜</strong>打开搜索</li><li>选择最后一项“<strong>Url关键词</strong>”</li><li>输入<strong>m3u8</strong>，返回，再返回，回到那个<strong>有纸飞机的界面</strong></li><li>列表中就剩一个了（如果你点击了多个回放，就有多个选项，<strong>每个对应一个回放</strong>）</li><li>然后分别点击进入，<strong>长按链接</strong>，提示复制成功</li><li>分别将这些链接<strong>发送给电脑</strong>，可以使用qq、微信等</li></ul><h2 id="电脑下载"><a href="#电脑下载" class="headerlink" title="电脑下载"></a>电脑下载</h2><p><a href="https://link.jscdn.cn/1drv/aHR0cHM6Ly8xZHJ2Lm1zL3UvcyFBaFAtdlNZTXZHRUpoUXZoX2R4YTJQMmNhV2Q2P2U9SWdWR3ZB.zip">下载链接</a></p><p>这个软件是开源的可以在<a href="https://www.gyan.dev/ffmpeg/builds/#tools">ffmpeg</a>下载</p><h4 id="电脑"><a href="#电脑" class="headerlink" title="电脑"></a>电脑</h4><h5 id="一、准备好指令"><a href="#一、准备好指令" class="headerlink" title="一、准备好指令"></a>一、准备好指令</h5><ul><li>解压下载的压缩包</li><li>得到如此文件夹，打开bin文件夹</li><li>你能看到三个exe文件，不用运行她们。先右键，新建一个txt文档，随便起个名字</li><li>输入以下内容<br> <code>ffmpeg -i &quot;从手机上发来的链接&quot; -c copy 保存的文件名.mp4</code><br> 将其中的<code>从手机上发来的链接</code>和<code>保存的文件名</code>这几个汉字，分别替换成你从手机上辛辛苦苦搞到的<strong>链接</strong>，和你要保存这个视频的<strong>文件名</strong>。</li><li>替换好以后，选择全部内容，右键，复制</li></ul><h5 id="二、使用软件下载"><a href="#二、使用软件下载" class="headerlink" title="二、使用软件下载"></a>二、使用软件下载</h5><ul><li>复制完之后，回到文件浏览器，在刚才那个目录下，你应该有了四个文件——三个exe和一个文本文档。接着按住键盘上的Shift（上档）按键，在空白处点击右键。<br> 可以发现有个在此处打开balabala的，有可能你看到的是<code>在此处的打开命令行窗口</code>，都是一样的，点就完事了。</li><li>然后出来一个小黑框，就叫她小黑吧，在小黑的空白处（没有文字的地方）按一下右键。</li><li>然后你刚才复制的东西——啪一下就粘贴上去了，接下来只要按一下回车~<br> duang duang duang duang~一大堆东西往上窜，等待一会后，在刚才那个目录下，就有了一个mp4文件，这就是你的直播了。</li></ul>]]></content>
      
      
      <categories>
          
          <category> 实用小技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 钉钉解除限制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golang笔记</title>
      <link href="/2023/03/12/Go%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/03/12/Go%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="一、入门"><a href="#一、入门" class="headerlink" title="一、入门"></a>一、入门</h2><p>入门容易精通难啊，Golang语法有些严格，相比Python和Java不好学</p><h3 id="编译-运行"><a href="#编译-运行" class="headerlink" title="编译 + 运行"></a>编译 + 运行</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//编译</span></span><br><span class="line"><span class="keyword">go</span> build hello.<span class="keyword">go</span></span><br><span class="line"><span class="comment">//运行</span></span><br><span class="line">hello.exe</span><br><span class="line"><span class="comment">//编译+运行</span></span><br><span class="line"><span class="keyword">go</span> run hello.<span class="keyword">go</span></span><br></pre></td></tr></table></figure><h3 id="入门案例"><a href="#入门案例" class="headerlink" title="入门案例"></a>入门案例</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123; <span class="comment">//func 是一个关键字，表示一个函数，main表示是一个主函数</span></span><br><span class="line">fmt.Println(<span class="string">&quot;hello world!&quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;hello Java&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">这里声明了变量num就必须使用否则会报错</span></span><br><span class="line"><span class="comment"># command-line-arguments</span></span><br><span class="line"><span class="comment">.\hello.go:8:6: num declared and not used</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><ol start="3"><li>转译字符</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">\r ： 会替换前面的字符</span><br><span class="line">ex.</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span> <span class="comment">//fmt包中提供格式化，输出，输入函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;天龙八部\r雪山飞&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果：雪山飞部</span></span><br></pre></td></tr></table></figure><p>练习: 输出以下图片</p><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230308230001435.png" alt="image-20230308230001435"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span> <span class="comment">//fmt包中提供格式化，输出，输入函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;姓名\t年龄\t籍贯\t住址\njohn\t12\t河北\t北京&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">块注释(多行注释)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="代码风格"><a href="#代码风格" class="headerlink" title="代码风格"></a>代码风格</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">table 整体向右</span><br><span class="line">shift + table 整体向左</span><br><span class="line"></span><br><span class="line">格式化后在命令行显示：(但是实际上代码不会变)</span><br><span class="line">gofmt hello.<span class="keyword">go</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span> <span class="comment">//fmt包中提供格式化，输出，输入函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">&quot;姓名\t年龄\t籍贯\t住址\njohn\t12\t河北\t北京&quot;</span>)</span><br><span class="line">        fmt.Println(<span class="string">&quot;姓名\t年龄\t籍贯\t住址\njohn\t12\t河北\t北京&quot;</span>)</span><br><span class="line">        fmt.Println(<span class="string">&quot;姓名\t年龄\t籍贯\t住址\njohn\t12\t河北\t北京&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">一行字符数过多</span><br><span class="line">fmt.Println(<span class="string">&quot;ffffffffffffff&quot;</span>,</span><br><span class="line"><span class="string">&quot;fffasdasascasc&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ffffasxasxa&quot;</span>)</span><br><span class="line"></span><br><span class="line">api: application program <span class="keyword">interface</span>:应用程序编程接口</span><br><span class="line">就是Go的各个包的各个函数</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Golang中，调用一个函数的方式</span><br><span class="line"><span class="keyword">import</span> 包</span><br><span class="line">使用 <span class="string">&#x27;包名.函数名&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="dos命令"><a href="#dos命令" class="headerlink" title="dos命令"></a>dos命令</h3><table><thead><tr><th>Dos命令</th><th></th></tr></thead><tbody><tr><td>查看当前目录</td><td>dir</td></tr><tr><td>清屏</td><td>cls(苍老师)</td></tr><tr><td>切换到F盘</td><td>cd &#x2F;d f: （F:）</td></tr><tr><td>切换到当前盘Gowork目录（绝对路径）</td><td>cd d:\Gowork</td></tr><tr><td>切换到当前盘Gowork目录（相对路径）</td><td>cd Gowrk</td></tr><tr><td>回到顶级目录(D:\Git\Git&gt;cd )</td><td>cd \</td></tr><tr><td>新建目录</td><td>md</td></tr><tr><td>删除目录(remove directory)</td><td>rd</td></tr><tr><td>强制删除目录&lt;q:不询问 s:层级删除&gt;</td><td>rd &#x2F;q&#x2F;s</td></tr><tr><td>添加文件并创建文件</td><td>echo hello &gt;  hello.txt</td></tr><tr><td>复制文件</td><td>copy abc.txt a.txt</td></tr><tr><td>剪切文件</td><td>move abc.txt</td></tr><tr><td>删除文件</td><td>del abc.txt</td></tr><tr><td>退出</td><td>exit</td></tr></tbody></table><h3 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h3><table><thead><tr><th>快捷键</th><th></th></tr></thead><tbody><tr><td>alt + shift + 上下键</td><td>类似ctrl + D</td></tr><tr><td>alt + 上下键</td><td>将该行上下移动</td></tr><tr><td>ctrl + shift + “- or +”</td><td>使屏幕缩放</td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr><tr><td></td><td></td></tr></tbody></table><p>作业:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>编写 Hello</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>输出爱心</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;\t*\t\t\t\t\t*\n*&quot;</span>,<span class="string">&quot;\t\t*\tI love golang\t*\t\t*\n&quot;</span>,<span class="string">&quot;\t*\t\t\t\t\t*\n&quot;</span>,<span class="string">&quot;\t\t*\t\t\t*\n&quot;</span>,<span class="string">&quot;\t\t\t*\t*\n&quot;</span>,<span class="string">&quot;\t\t\t    *&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230309112527724.png" alt="image-20230309112527724"></p><h3 id="本章内容回顾"><a href="#本章内容回顾" class="headerlink" title="本章内容回顾"></a>本章内容回顾</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.SDK是什么</span><br><span class="line">SDK是软件开发工具包</span><br><span class="line"></span><br><span class="line">2.Golang环境变量配置：</span><br><span class="line">GOROOR:指定 go sdk安装目录。</span><br><span class="line">Path:指定 sdkbin目录:go.exe godoc.exe gofmt.exe</span><br><span class="line">GOPATH:就是golang项目的工作目录: 所有项目的源码都在这里。</span><br><span class="line"></span><br><span class="line">3.规则</span><br><span class="line">go定义的变量 or import包 必须使用 不用会报错</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="二、基础"><a href="#二、基础" class="headerlink" title="二、基础"></a>二、基础</h2><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><ol><li><p>入门</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//定义变量/声明变量</span></span><br><span class="line"><span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line"><span class="comment">//赋值</span></span><br><span class="line">i = <span class="number">10</span></span><br><span class="line">fmt.Println(<span class="string">&quot;i=&quot;</span>,i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//int 默认值是0</span></span><br></pre></td></tr></table></figure></li><li><p>使用方式</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line"><span class="number">2.</span> <span class="keyword">var</span> num = <span class="number">10.11</span></span><br><span class="line"><span class="number">3.</span> name := <span class="string">&quot;tom&quot;</span></span><br><span class="line"></span><br><span class="line">ex.</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">name := <span class="number">100</span></span><br><span class="line">y1, y2 := <span class="number">15</span>, <span class="string">&quot;beihai&quot;</span></span><br><span class="line">fmt.Println(y1,y2)</span><br><span class="line">fmt.Println(name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 还有全局变量</span></span><br><span class="line">ex:</span><br><span class="line"><span class="keyword">var</span>(</span><br><span class="line">n3 = <span class="number">300</span></span><br><span class="line">    n4 = <span class="number">500</span></span><br><span class="line">    name2 = </span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//这里注意定义全局变量的时候不能用 a3 := &quot;521&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//变量在同一个作用域(在一个函数或者在代码块)内不能重名</span></span><br><span class="line"><span class="keyword">var</span> i <span class="type">int</span> = <span class="number">59</span></span><br><span class="line">i := <span class="number">99</span></span><br><span class="line">简单说就是不能重复</span><br><span class="line"><span class="keyword">var</span> d <span class="type">int</span> = <span class="number">20</span></span><br><span class="line"><span class="keyword">var</span> d <span class="type">int</span> = <span class="number">30</span></span><br></pre></td></tr></table></figure></li><li><p>数据类型</p></li></ol><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230310085412786.png" alt="image-20230310085412786" style="zoom:67%;" /><p>3.1 整数类型：</p><p>​<img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230310091010550.png" alt="image-20230310091010550" style="zoom: 67%;" /></p><p>整数使用细节</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">查看某个变量的字节大小和数据类型</span><br><span class="line">fmt.Printf(<span class="string">&quot;&quot;</span>) 用于做格式化输出</span><br><span class="line">ex:</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;unsafe&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> n2 <span class="type">int8</span> = <span class="number">-128</span></span><br><span class="line">fmt.Println(<span class="string">&quot;n2 的 类型 %T n2占用的字节数是 %d &quot;</span>, n2, unsafe.Sizeof(n2))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.2 小数类型</p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230310092627191.png" alt="image-20230310092627191" style="zoom:67%;" /><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">这里有一点要注意<span class="type">float64</span>位比<span class="type">float32</span>位更加准确</span><br><span class="line">默认是<span class="type">float64</span></span><br><span class="line"></span><br><span class="line">num1 := <span class="number">2.1234e2</span>  <span class="comment">// 5.1234 * 10的2次方</span></span><br><span class="line">num2 := <span class="number">2.1234e-2</span>  <span class="comment">// 5.1234 / 10的2次方</span></span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq_41542894/article/details/104109261">https://blog.csdn.net/qq_41542894/article/details/104109261</a></p><p>字符串定义之后就不可变</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s4 <span class="type">string</span> = <span class="string">`你好抱抱`</span><span class="comment">//可以用反引号</span></span><br></pre></td></tr></table></figure><h3 id="数据类型转换"><a href="#数据类型转换" class="headerlink" title="数据类型转换"></a>数据类型转换</h3><h4 id="基本数据类型转成String"><a href="#基本数据类型转成String" class="headerlink" title="基本数据类型转成String"></a>基本数据类型转成String</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>fmt.Sprintf(<span class="string">&quot;&quot;</span>)</span><br><span class="line">ex:</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> n1 <span class="type">float32</span> = <span class="number">12.5</span></span><br><span class="line"><span class="keyword">var</span> s1 <span class="type">string</span> = fmt.Sprintf(<span class="string">&quot;%f&quot;</span>,n1)</span><br><span class="line">fmt.Printf(<span class="string">&quot;%q&quot;</span>,s1)</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>strconv.FormatInt(<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">//这里不太好用需要强转成64位</span></span><br><span class="line">ex:</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> n1 <span class="type">int</span> = <span class="number">19</span></span><br><span class="line"><span class="keyword">var</span> s1 <span class="type">string</span> = strconv.FormatInt(<span class="type">int64</span>(n1),<span class="number">10</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;%v&quot;</span>,s1)</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><h4 id="String类型转成基本数据类型"><a href="#String类型转成基本数据类型" class="headerlink" title="String类型转成基本数据类型"></a>String类型转成基本数据类型</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">parse 解析</span><br><span class="line">代码：</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> s1 <span class="type">string</span> = <span class="string">&quot;true&quot;</span></span><br><span class="line"><span class="keyword">var</span> b <span class="type">bool</span></span><br><span class="line"><span class="comment">//ParseBool函数返回值有两个:(value bool, err error)</span></span><br><span class="line"><span class="comment">//value是布尔类型的数据，err是出现的错误</span></span><br><span class="line"><span class="comment">//只需要获取布尔数据，不要err可以用_直接忽略</span></span><br><span class="line">b, _= strconv.ParseBool(s1)</span><br><span class="line">fmt.Printf(<span class="string">&quot;b的数据类型是%T, b = %v\n&quot;</span>,b,b)</span><br><span class="line"></span><br><span class="line"><span class="comment">//string --&gt; int64</span></span><br><span class="line"><span class="keyword">var</span> s2 <span class="type">string</span> = <span class="string">&quot;19&quot;</span></span><br><span class="line"><span class="keyword">var</span> num1 <span class="type">int64</span></span><br><span class="line">num1, _ = strconv.ParseInt(s2,<span class="number">10</span>,<span class="number">64</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;num1的数据类型是%T, num1 = %v\n&quot;</span>,num1,num1)</span><br><span class="line"></span><br><span class="line"><span class="comment">//string --&gt; float32/float64</span></span><br><span class="line"><span class="keyword">var</span> s3 <span class="type">string</span> = <span class="string">&quot;3.14&quot;</span></span><br><span class="line"><span class="keyword">var</span> f1 <span class="type">float64</span></span><br><span class="line">f1, _ = strconv.ParseFloat(s3,<span class="number">64</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;f1的数据类型是%T, f1 = %v\n&quot;</span>,f1,f1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> s4 <span class="type">string</span> = <span class="string">&quot;3.14&quot;</span></span><br><span class="line"><span class="keyword">var</span> f2 <span class="type">float64</span></span><br><span class="line">f2, _ = strconv.ParseFloat(s4,<span class="number">32</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;f2的数据类型是%T, f2 = %v&quot;</span>,f2,f2)</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//运行结果</span></span><br><span class="line">b的数据类型是<span class="type">bool</span>, b = <span class="literal">true</span></span><br><span class="line">num1的数据类型是<span class="type">int64</span>, num1 = <span class="number">19</span></span><br><span class="line">f1的数据类型是<span class="type">float64</span>, f1 = <span class="number">3.14</span></span><br><span class="line">f2的数据类型是<span class="type">float64</span>, f2 = <span class="number">3.140000104904175</span></span><br></pre></td></tr></table></figure><h4 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h4><p>就是内存地址</p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230311085922328.png" alt="image-20230311085922328" style="zoom: 67%;" /><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> age <span class="type">int</span> = <span class="number">10</span></span><br><span class="line"><span class="comment">// &amp;符号 + 变量 可以获取变量内存的地址</span></span><br><span class="line">fmt.Println(&amp;age) <span class="comment">//0xc00000e0a8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个指针变量-&gt; pointer</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">var 代表要声明一个变量</span></span><br><span class="line"><span class="comment">ptr 指针变量的名字</span></span><br><span class="line"><span class="comment">ptr 对应的类型是：*int 是一个指针类型（可以理解为 指向int类型的指针)</span></span><br><span class="line"><span class="comment">&amp;age 就是一个地址：是ptr具体的值</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> ptr *<span class="type">int</span> = &amp;age</span><br><span class="line">fmt.Println(ptr)</span><br><span class="line">fmt.Println(<span class="string">&quot;ptr本身存储空间的地址:&quot;</span>,&amp;ptr)</span><br><span class="line"></span><br><span class="line"><span class="comment">//想获取ptr本身地址指向的数据</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;ptr指向的数值为:%v&quot;</span>, *ptr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">&amp;取内存地址</span></span><br><span class="line"><span class="comment">*取内存地址所指的值</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h5 id="指针的4个细节"><a href="#指针的4个细节" class="headerlink" title="指针的4个细节"></a>指针的4个细节</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.通过指针改变指向值</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> num <span class="type">int</span> = <span class="number">10</span></span><br><span class="line">fmt.Println(<span class="string">&quot;num = &quot;</span>, num)</span><br><span class="line"><span class="keyword">var</span> ptr *<span class="type">int</span> = &amp;num</span><br><span class="line">fmt.Println(<span class="string">&quot;num的地址ptr = &quot;</span>, ptr)</span><br><span class="line">fmt.Println(<span class="string">&quot;ptr指向的数值为: &quot;</span>, *ptr)</span><br><span class="line"></span><br><span class="line">*ptr = <span class="number">20</span></span><br><span class="line">fmt.Println(<span class="string">&quot;将ptr改变指向数值: &quot;</span>, num)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.指针变量接受的一定是地址值</span></span><br><span class="line"><span class="comment">// 3.指针变量的地址不可以不匹配</span></span><br><span class="line"><span class="comment">// 4.基本数据类型，都有对应的指针类型</span></span><br></pre></td></tr></table></figure><h3 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.可以用‘_&#x27;来忽略一些东西</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">_<span class="string">&quot;strconv&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//2. 包名：尽量保持package的名字和目录保持一直，尽量采取有意义的包名</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">main包是一个程序的入口，如果不定义为package main则不能执行</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//3. 如果变量名、函数名、常量名首字母大写，则可以被其他的包访问；</span></span><br><span class="line"><span class="comment">//如果首字母小写，则只能在本包使用</span></span><br></pre></td></tr></table></figure><h3 id="关于导包"><a href="#关于导包" class="headerlink" title="关于导包"></a>关于导包</h3><p><a href="https://zhuanlan.zhihu.com/p/109828249">https://zhuanlan.zhihu.com/p/109828249</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">有些问题现在不会</span><br><span class="line">但基本解决办法</span><br><span class="line"><span class="number">1.</span> 配置GOPATH</span><br><span class="line"><span class="comment">//到src上一级目录下</span></span><br><span class="line"><span class="number">2.</span> <span class="keyword">go</span> mod init 目录名字</span><br><span class="line"><span class="comment">//这里目录名字是main.go上一级目录</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">module demo03</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">go 1.20</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="io"><a href="#io" class="headerlink" title="io"></a>io</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.Scanln</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// fmt.Println(&quot;你好请输入你的年龄: &quot;)</span></span><br><span class="line"><span class="comment">// age,_ :=  fmt.ScanIn()</span></span><br><span class="line"><span class="comment">// fmt.Println(&quot;你的年龄为: &quot;, age)</span></span><br><span class="line"><span class="keyword">var</span> age <span class="type">int</span></span><br><span class="line">fmt.Println(<span class="string">&quot;请录入学生的年龄: &quot;</span>)</span><br><span class="line">fmt.Scanln(&amp;age)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> name <span class="type">string</span></span><br><span class="line">fmt.Println(<span class="string">&quot;请录入学生的姓名: &quot;</span>)</span><br><span class="line">fmt.Scanln(&amp;name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> score <span class="type">float32</span></span><br><span class="line">fmt.Println(<span class="string">&quot;请录入学生的成绩: &quot;</span>)</span><br><span class="line">fmt.Scanln(&amp;score)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> isVIP <span class="type">bool</span></span><br><span class="line">fmt.Println(<span class="string">&quot;请录入学生是否为VIP: &quot;</span>)</span><br><span class="line">fmt.Scanln(&amp;isVIP)</span><br><span class="line"></span><br><span class="line">fmt.Printf(<span class="string">&quot;学生的年龄为: %v, 姓名为: %v, 成绩为: %v, 是否为VIP: %v &quot;</span>,age,name,score,isVIP)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方式2：Scanf</span></span><br><span class="line">fmt.Println(<span class="string">&quot;请录入学生的年龄,姓名,成绩,是否是VIP,使用空格进行分隔&quot;</span>)</span><br><span class="line">fmt.Scanf(<span class="string">&quot;%d %s %f %t&quot;</span>, &amp;age, &amp;name, &amp;score, &amp;isVIP)</span><br><span class="line">fmt.Printf(<span class="string">&quot;学生的年龄为: %v, 姓名为: %v, 成绩为: %v, 是否为VIP: %v &quot;</span>,age,name,score,isVIP)</span><br></pre></td></tr></table></figure><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230311104205536.png" alt="image-20230311104205536"></p><h3 id="分支结构"><a href="#分支结构" class="headerlink" title="分支结构"></a>分支结构</h3><h4 id="if"><a href="#if" class="headerlink" title="if"></a>if</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> count <span class="type">int</span> = <span class="number">30</span></span><br><span class="line"><span class="keyword">if</span> count &lt;= <span class="number">30</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;sorry 口罩存量不足&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">if count := 20;count &lt;= 30 &#123;</span></span><br><span class="line"><span class="comment">fmt.Println(&quot;sorry 口罩存量不足&quot;)</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h4 id="if-else"><a href="#if-else" class="headerlink" title="if else"></a>if else</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> count := <span class="number">20</span>;count &gt;= <span class="number">30</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;sorry 口罩存量不足&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;需要加产了&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="if多分支"><a href="#if多分支" class="headerlink" title="if多分支"></a>if多分支</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> score <span class="type">float32</span></span><br><span class="line">fmt.Println(<span class="string">&quot;请输入你的成绩: &quot;</span>)</span><br><span class="line">fmt.Scanln(&amp;score)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> score &gt;= <span class="number">90</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;A&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> score &gt;= <span class="number">80</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;B&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> score &gt;= <span class="number">70</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;C&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> score &gt;= <span class="number">60</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;D&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;E&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> score <span class="type">int</span></span><br><span class="line"><span class="built_in">println</span>(<span class="string">&quot;请输入你的成绩：&quot;</span>)</span><br><span class="line">fmt.Scanln(&amp;score)</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> score/<span class="number">10</span>&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">10</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为A级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">9</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为A级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">8</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为B级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">7</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为C级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为D级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为E级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为E级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为E级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为E级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为E级&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为E级&quot;</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">fmt.Println(<span class="string">&quot;输入错误&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//default 可以放在&#123;&#125;中任何地方</span></span><br></pre></td></tr></table></figure><h5 id="switch细节"><a href="#switch细节" class="headerlink" title="switch细节"></a>switch细节</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="comment">// 类型必须匹配</span></span><br><span class="line"><span class="number">2.</span> <span class="comment">// switch 后面的条件可以加变量，常量.....</span></span><br><span class="line"><span class="number">3.</span> <span class="comment">// case可以加多个例如：</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>:</span><br><span class="line">fmt.Println(<span class="string">&quot;😄&quot;</span>)</span><br><span class="line"><span class="number">4.</span> <span class="comment">//default不是必须的</span></span><br><span class="line"><span class="number">5.</span> <span class="comment">//switch特有用法：</span></span><br><span class="line">a := <span class="number">2</span></span><br><span class="line"><span class="keyword">switch</span> &#123;</span><br><span class="line"><span class="keyword">case</span> a == <span class="number">1</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;aaa&quot;</span>)</span><br><span class="line"><span class="keyword">case</span> a == <span class="number">2</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;bbb&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">6.</span> <span class="comment">// switch后可以直接声明/定义一个变量，但是要以;结束</span></span><br><span class="line"><span class="keyword">switch</span> b := <span class="number">7</span> ; &#123;</span><br><span class="line">    <span class="keyword">case</span> b &gt; <span class="number">6</span> :</span><br><span class="line">    fmt.Println(<span class="string">&quot;大于6&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">7.</span> <span class="comment">// switch穿透，利用fallthrough关键字</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">7</span> :</span><br><span class="line">fmt.Println(<span class="string">&quot;您的等级为C级&quot;</span>)</span><br><span class="line"><span class="keyword">fallthrough</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">6</span> :</span><br><span class="line"></span><br><span class="line"><span class="comment">/*fmt.Println(&quot;您的等级为D级&quot;)</span></span><br><span class="line"><span class="comment">这里如果输入70 则会打印</span></span><br><span class="line"><span class="comment">您的等级为C级</span></span><br><span class="line"><span class="comment">您的等级为D级*/</span></span><br></pre></td></tr></table></figure><h3 id="循环结构"><a href="#循环结构" class="headerlink" title="循环结构"></a>循环结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">golang中只有for没有while</span><br></pre></td></tr></table></figure><h4 id="for"><a href="#for" class="headerlink" title="for"></a>for</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 初始表达式; 布尔表达式; 迭代因子&#123;</span><br><span class="line">循环体;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> sum <span class="type">int</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++ &#123;</span><br><span class="line">sum += i</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="for细节"><a href="#for细节" class="headerlink" title="for细节"></a>for细节</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="comment">// 格式灵活</span></span><br><span class="line">i := <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i &lt;= <span class="number">5</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;迭代5次&quot;</span>)</span><br><span class="line">i++</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.</span> <span class="comment">// 死循环</span></span><br><span class="line"><span class="keyword">var</span> n <span class="type">int</span> = <span class="number">0</span></span><br><span class="line">i := <span class="literal">true</span></span><br><span class="line"><span class="keyword">for</span> i == <span class="literal">true</span>&#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;迭代第%v次&quot;</span>, n)</span><br><span class="line">n++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;循环&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> ; ; &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;循环&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="for-range-重点"><a href="#for-range-重点" class="headerlink" title="for range(重点)"></a>for range(重点)</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> str <span class="type">string</span> = <span class="string">&quot;hello golang你好啊&quot;</span></span><br><span class="line"><span class="comment">// 方式一: 普通for循环: 按照字节进行遍历输出的 （暂时不用中文）</span></span><br><span class="line"><span class="comment">// for i := 0; i &lt; len(str); i++ &#123;</span></span><br><span class="line"><span class="comment">// fmt.Printf(&quot;循环第 %v 次,第 %v 次循环结果为 %c \n&quot;, i, i, str[i])</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 方式二: for range</span></span><br><span class="line"><span class="keyword">for</span> i , value := <span class="keyword">range</span> str&#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;索引为：%d, 具体的值为：%c\n&quot;</span>, i, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">索引为：0, 具体的值为：h</span></span><br><span class="line"><span class="comment">索引为：1, 具体的值为：e</span></span><br><span class="line"><span class="comment">索引为：2, 具体的值为：l</span></span><br><span class="line"><span class="comment">索引为：3, 具体的值为：l</span></span><br><span class="line"><span class="comment">索引为：4, 具体的值为：o</span></span><br><span class="line"><span class="comment">索引为：5, 具体的值为：</span></span><br><span class="line"><span class="comment">索引为：6, 具体的值为：g</span></span><br><span class="line"><span class="comment">索引为：7, 具体的值为：o</span></span><br><span class="line"><span class="comment">索引为：8, 具体的值为：l</span></span><br><span class="line"><span class="comment">索引为：9, 具体的值为：a</span></span><br><span class="line"><span class="comment">索引为：10, 具体的值为：n</span></span><br><span class="line"><span class="comment">索引为：11, 具体的值为：g</span></span><br><span class="line"><span class="comment">索引为：12, 具体的值为：你</span></span><br><span class="line"><span class="comment">索引为：15, 具体的值为：好</span></span><br><span class="line"><span class="comment">索引为：18, 具体的值为：啊</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="break"><a href="#break" class="headerlink" title="break"></a>break</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum <span class="type">int</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span> ; i &lt;= <span class="number">100</span> ; i++ &#123;</span><br><span class="line">sum += i</span><br><span class="line">fmt.Println(sum)</span><br><span class="line"><span class="keyword">if</span> sum &gt;= <span class="number">300</span> &#123;</span><br><span class="line"><span class="comment">//停止正在执行的循环</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="break细节"><a href="#break细节" class="headerlink" title="break细节"></a>break细节</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="comment">// switch语句可以省略break</span></span><br><span class="line"><span class="number">2.</span> <span class="comment">// break可以结束正在执行的循环</span></span><br><span class="line"><span class="number">3.</span> <span class="comment">// lable标签可以直接停掉</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">labe2:</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++ &#123;</span><br><span class="line"><span class="keyword">for</span> j := <span class="number">2</span>; j &lt;= <span class="number">4</span>; j++ &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;i: %v, j: %v\n&quot;</span>, i, j)</span><br><span class="line"><span class="keyword">if</span> i ==<span class="number">2</span> &amp;&amp; j == <span class="number">2</span> &#123;</span><br><span class="line"><span class="keyword">break</span> labe2</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span> ; i &lt;= <span class="number">100</span>; i ++ &#123;</span><br><span class="line"><span class="keyword">if</span> i % <span class="number">6</span> == <span class="number">0</span> &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span> ; i &lt;= <span class="number">100</span>; i ++ &#123;</span><br><span class="line"><span class="keyword">if</span> i % <span class="number">6</span> != <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">continue</span> <span class="comment">// 结束本次循环，继续下一次循环</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="continue细节"><a href="#continue细节" class="headerlink" title="continue细节"></a>continue细节</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">结束离他近的进程</span><br><span class="line">然后继续开始下一个</span><br></pre></td></tr></table></figure><h3 id="goto"><a href="#goto" class="headerlink" title="goto"></a>goto</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;hello g1&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> == <span class="number">1</span>&#123;</span><br><span class="line"><span class="keyword">goto</span> label1<span class="comment">//goto 一般配合label1使用</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">&quot;hello g2&quot;</span>)</span><br><span class="line"></span><br><span class="line">label1:</span><br><span class="line">fmt.Println(<span class="string">&quot;hello g3&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">结果:</span></span><br><span class="line"><span class="comment">hello g1</span></span><br><span class="line"><span class="comment">hello g3</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="return"><a href="#return" class="headerlink" title="return"></a>return</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++ &#123;</span><br><span class="line">fmt.Println(i)</span><br><span class="line"><span class="keyword">if</span> i == <span class="number">14</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">&quot;结束了当前函数&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="三、函数"><a href="#三、函数" class="headerlink" title="三、函数"></a>三、函数</h2><h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> 函数名<span class="params">(形参列表)</span></span>(返回值类型列表)&#123;</span><br><span class="line"><span class="keyword">return</span> + 返回值列表</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="样例定义函数"><a href="#样例定义函数" class="headerlink" title="样例定义函数"></a>样例定义函数</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cal</span> <span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span> (<span class="type">int</span>) &#123; <span class="comment">//如果返回值类型只有一个的话【可以去掉括号</span></span><br><span class="line"><span class="keyword">var</span> sum <span class="type">int</span> = <span class="number">0</span></span><br><span class="line">sum += num1</span><br><span class="line">sum += num2</span><br><span class="line"><span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">sum01 := cal(<span class="number">10</span>,<span class="number">20</span>)</span><br><span class="line">fmt.Println(sum01)</span><br><span class="line"></span><br><span class="line">sum02 := cal(<span class="number">30</span>,<span class="number">50</span>)</span><br><span class="line">fmt.Println(sum02)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="函数细节"><a href="#函数细节" class="headerlink" title="函数细节"></a>函数细节</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> 函数名</span><br><span class="line">首字母不为数字</span><br><span class="line">首字母大写可以被本包文件和其他包文件使用（类似public）</span><br><span class="line">首字母小写只能被本包文件使用（类似private）</span><br><span class="line"><span class="number">2.</span> 形参列表</span><br><span class="line">个数：可以是一个参数，可以是n个参数，也可以是<span class="number">0</span>个参数</span><br><span class="line"><span class="number">3.</span> 返回值类型列表</span><br><span class="line">返回<span class="number">0</span>个：</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cal</span> <span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span> &#123; <span class="comment">//如果返回值类型只有一个的话【可以去掉括号</span></span><br><span class="line"><span class="keyword">var</span> sum <span class="type">int</span> = <span class="number">0</span></span><br><span class="line">sum += num1</span><br><span class="line">sum += num2</span><br><span class="line">fmt.Println(sum)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">cal(<span class="number">50</span>,<span class="number">90</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">返回<span class="number">1</span>个:</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cal</span> <span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span> <span class="type">int</span></span><br><span class="line"></span><br><span class="line">返回多个:</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cal2</span> <span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span> (<span class="type">int</span>, <span class="type">int</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> sum</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="内存分析"><a href="#内存分析" class="headerlink" title="内存分析"></a>内存分析</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">栈(基本数据类型)</span><br><span class="line"></span><br><span class="line">堆(复杂数据类型)</span><br><span class="line"></span><br><span class="line">代码区(代码本身)</span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">exchangeNum</span> <span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span> (<span class="type">int</span>,<span class="type">int</span>)&#123;</span><br><span class="line"><span class="keyword">var</span> t <span class="type">int</span></span><br><span class="line">t = num1</span><br><span class="line">num1 = num2</span><br><span class="line">num2 = t</span><br><span class="line"><span class="keyword">return</span> num1,num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">n1 := <span class="number">15</span></span><br><span class="line">n2 := <span class="number">20</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;交换前n1 = %v, n2 = %v\n&quot;</span>,n1,n2)</span><br><span class="line">n1,n2 = exchangeNum(n1,n2)</span><br><span class="line">fmt.Printf(<span class="string">&quot;交换后n1 = %v, n2 = %v\n&quot;</span>,n1,n2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="golang中不支持重载"><a href="#golang中不支持重载" class="headerlink" title="golang中不支持重载"></a>golang中不支持重载</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">重载的含义就是如果有两个函数，这两个函数函数名相同，形参列表不同</span><br><span class="line">ex:</span><br><span class="line">func exchangeNum (num1 int, num2 int) (int,int)&#123;</span><br><span class="line">var t int</span><br><span class="line">t = num1</span><br><span class="line">num1 = num2</span><br><span class="line">num2 = t</span><br><span class="line">return num1,num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func exchangeNum (num1 int) (int,int)&#123;</span><br><span class="line">var t int</span><br><span class="line">t = num1</span><br><span class="line">num1 = num2</span><br><span class="line">num2 = t</span><br><span class="line">return num1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">可变参数...</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span> <span class="params">(args...<span class="type">int</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(args); i++ &#123;</span><br><span class="line">fmt.Println(args[i])</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">test()</span><br><span class="line">fmt.Printf(<span class="string">&quot;------------\n&quot;</span>)</span><br><span class="line">test(<span class="number">3</span>)</span><br><span class="line">test(<span class="number">37</span>,<span class="number">57</span>,<span class="number">59</span>,<span class="number">66</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">结果:</span></span><br><span class="line"><span class="comment">------------</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">37</span></span><br><span class="line"><span class="comment">57</span></span><br><span class="line"><span class="comment">59</span></span><br><span class="line"><span class="comment">66</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h5 id="函数可以作为参数"><a href="#函数可以作为参数" class="headerlink" title="函数可以作为参数"></a>函数可以作为参数</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 函数是一种数据类型</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(num <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">fmt.Println(num)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">a := test</span><br><span class="line"><span class="comment">//a的类型是:func(int),test函数的类型是func(int)</span></span><br><span class="line">fmt.Printf(<span class="string">&quot;a的类型是:%T,test函数的类型是%T\n&quot;</span>,a , test)</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过变量对函数调用</span></span><br><span class="line">a(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用test02的函数</span></span><br><span class="line">test02(<span class="number">10</span>,<span class="number">3.19</span>,test)</span><br><span class="line">test02(<span class="number">10</span>,<span class="number">3.19</span>,a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="自定义数据类型"><a href="#自定义数据类型" class="headerlink" title="自定义数据类型"></a>自定义数据类型</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">利用 <span class="keyword">type</span> 关键字</span><br><span class="line"><span class="keyword">type</span> myInt=<span class="type">int</span> <span class="comment">//起别名</span></span><br><span class="line"><span class="keyword">type</span> myFloat <span class="type">float32</span> <span class="comment">// 自定义数据类型</span></span><br><span class="line"><span class="keyword">var</span> num1 myInt = <span class="number">30</span></span><br><span class="line"><span class="keyword">var</span> num2 myFloat = <span class="number">2.75</span></span><br><span class="line">fmt.Println(num1,num2)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对函数返回值命名</span></span><br><span class="line"><span class="comment">// 特别注意的是这里不要带 :=</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test05</span><span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span>(resSum <span class="type">int</span>,resSub <span class="type">int</span>) &#123;</span><br><span class="line">resSum = num1 + num2</span><br><span class="line">resSub = num1 - num2</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="init函数"><a href="#init函数" class="headerlink" title="init函数"></a>init函数</h3><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230312102623383.png" alt="image-20230312102623383"></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// init 函数总是一开始就被执行</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;demo09/testutil&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> <span class="type">int</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;test 函数被执行&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> num <span class="type">int</span> = test()<span class="comment">// 全局变量先被执行</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;main.go 中 init 函数被执行&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;main 函数被执行&quot;</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;Age= %v, Sex= %s, Name= %s&quot;</span>, testutil.Age, testutil.Sex, testutil.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">testutil.go 中 init 函数被执行</span></span><br><span class="line"><span class="comment">test 函数被执行</span></span><br><span class="line"><span class="comment">main.go 中 init 函数被执行</span></span><br><span class="line"><span class="comment">main 函数被执行</span></span><br><span class="line"><span class="comment">Age= 19, Sex= 女, Name= 小婵</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">在尝试导入一个包的时候会发现</span></span><br><span class="line"><span class="comment">init函数是现在全局变量之后被执行</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><h4 id="基础使用"><a href="#基础使用" class="headerlink" title="基础使用"></a>基础使用</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 定义匿名函数</span></span><br><span class="line">result := <span class="function"><span class="keyword">func</span> <span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;调用了匿名函数&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> num1 + num2</span><br><span class="line">&#125;(<span class="number">10</span>,<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">fmt.Println(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">&quot;----------------&quot;</span>)</span><br><span class="line"></span><br><span class="line">sub := <span class="function"><span class="keyword">func</span> <span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line"><span class="keyword">return</span> num1 - num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fmt.Println(sub(<span class="number">10</span>,<span class="number">20</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="defer关键字"><a href="#defer关键字" class="headerlink" title="defer关键字"></a>defer关键字</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(add(<span class="number">30</span>,<span class="number">60</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">add</span><span class="params">(num1 <span class="type">int</span>, num2 <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line"><span class="comment">// 不会立即执行defer之后的语句，二十将defer压入一个栈中，然后继续执行函数后面的语句</span></span><br><span class="line"><span class="comment">// 栈的特点：先进后出</span></span><br><span class="line"><span class="keyword">defer</span> fmt.Println(<span class="string">&quot;num1=&quot;</span>,num1)</span><br><span class="line"><span class="keyword">defer</span> fmt.Println(<span class="string">&quot;num2=&quot;</span>,num2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum <span class="type">int</span> = num1 + num2</span><br><span class="line">fmt.Println(<span class="string">&quot;sum=&quot;</span>,sum)</span><br><span class="line"><span class="keyword">return</span> sum</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="defer应用场景"><a href="#defer应用场景" class="headerlink" title="defer应用场景"></a>defer应用场景</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">比如想要关闭某个使用的资源，则在使用的时候直接随手<span class="keyword">defer</span>，因为<span class="keyword">defer</span>有延迟执行机制</span><br><span class="line">(函数执行完毕之后再执行<span class="keyword">defer</span>压入栈的机制)</span><br><span class="line">所以用完随手写个关闭，比较省事</span><br></pre></td></tr></table></figure><h3 id="字符串函数！！！"><a href="#字符串函数！！！" class="headerlink" title="字符串函数！！！"></a>字符串函数！！！</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;strconv&quot;</span></span><br><span class="line"><span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str := <span class="string">&quot;golang你好&quot;</span></span><br><span class="line"><span class="comment">//方式1：利用 range</span></span><br><span class="line"><span class="keyword">for</span> i ,value := <span class="keyword">range</span> str &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;索引为：%d,具体的值为：%c \n&quot;</span>, i, value)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方式2 ：利用 r := []rune(str)</span></span><br><span class="line">r := []<span class="type">rune</span>(str)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(r); i++ &#123;</span><br><span class="line">fmt.Printf(<span class="string">&quot;%c&quot;</span>,r[i])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字符串转整数</span></span><br><span class="line">num1,_ := strconv.Atoi(<span class="string">&quot;666&quot;</span>)</span><br><span class="line">fmt.Println(num1)<span class="comment">//666</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 整数转字符串</span></span><br><span class="line">str1 := strconv.Itoa(<span class="number">88</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;%v&quot;</span>,str1)<span class="comment">// 88</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//统计一个字符串里有几个指定的字串</span></span><br><span class="line">count := strings.Count(<span class="string">&quot;golangbeihaibei.com&quot;</span>,<span class="string">&quot;bei&quot;</span>)</span><br><span class="line">fmt.Println(count)<span class="comment">//2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//查找子串是否在指定的字符串中</span></span><br><span class="line">beiStr := strings.Contains(<span class="string">&quot;golangbeihaiaaaa&quot;</span>,<span class="string">&quot;beihai&quot;</span>)</span><br><span class="line">fmt.Println(beiStr) <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//不区分大小写的字符串比较 ---&gt; 项目中密码，或者用户名的对比</span></span><br><span class="line">userName := strings.EqualFold(<span class="string">&quot;hello&quot;</span>,<span class="string">&quot;HELLO&quot;</span>)</span><br><span class="line">fmt.Println(userName) <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//区分大小写比较</span></span><br><span class="line">fmt.Println(<span class="string">&quot;hello&quot;</span> == <span class="string">&quot;HELLO&quot;</span>) <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//返回字串在字符串第一次出现的索引值</span></span><br><span class="line">inDex := strings.Index(<span class="string">&quot;golangbeihaibei&quot;</span>,<span class="string">&quot;bei&quot;</span>)</span><br><span class="line">fmt.Println(inDex)<span class="comment">// 6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//字符串替换</span></span><br><span class="line"><span class="comment">// 这里最后一项 -1:全部替换2:替换两个</span></span><br><span class="line">rePlace := strings.Replace(<span class="string">&quot;golangbeihaibei&quot;</span>,<span class="string">&quot;bei&quot;</span>,<span class="string">&quot;666&quot;</span>, <span class="number">-1</span>)</span><br><span class="line">fmt.Println(rePlace)</span><br><span class="line"></span><br><span class="line"><span class="comment">//切分</span></span><br><span class="line">sPlit := strings.Split(<span class="string">&quot;go-lang-bei-hai-bei&quot;</span>,<span class="string">&quot;-&quot;</span>)</span><br><span class="line">fmt.Println(sPlit)</span><br><span class="line"></span><br><span class="line"><span class="comment">//大小写切换</span></span><br><span class="line">fmt.Println(strings.ToLower(<span class="string">&quot;Go&quot;</span>))</span><br><span class="line">fmt.Println(strings.ToUpper(<span class="string">&quot;go&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//字符串左右两边的空格去掉</span></span><br><span class="line">fmt.Println(strings.TrimSpace(<span class="string">&quot;go lang &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//将字符串左右两边指定的字符去掉</span></span><br><span class="line">fmt.Println(strings.Trim(<span class="string">&quot;~golang~&quot;</span>,<span class="string">&quot;~&quot;</span>))</span><br><span class="line"><span class="comment">//将字符串左边指定的字符去掉</span></span><br><span class="line">fmt.Println(strings.TrimLeft(<span class="string">&quot;~golang~&quot;</span>,<span class="string">&quot;~&quot;</span>))</span><br><span class="line"><span class="comment">//将字符串右边指定的字符去掉</span></span><br><span class="line">fmt.Println(strings.TrimRight(<span class="string">&quot;~golang~&quot;</span>,<span class="string">&quot;~&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断字符串是否以指定字符串开头</span></span><br><span class="line">fmt.Println(strings.HasPrefix(<span class="string">&quot;https://blog.csdn.net&quot;</span>,<span class="string">&quot;https&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断字符串是否以指定字符串结束</span></span><br><span class="line">fmt.Println(strings.HasSuffix(<span class="string">&quot;demo.png&quot;</span>,<span class="string">&quot;.jpg&quot;</span>))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="日期和时间函数"><a href="#日期和时间函数" class="headerlink" title="日期和时间函数"></a>日期和时间函数</h3><p><a href="https://blog.csdn.net/Dorgan/article/details/128248547">https://blog.csdn.net/Dorgan/article/details/128248547</a></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">需要导包 time</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">now := time.Now()</span><br><span class="line">fmt.Println(now)</span><br><span class="line">fmt.Printf(<span class="string">&quot;%T\n&quot;</span>,now)</span><br><span class="line">fmt.Printf(<span class="string">&quot;年：%v\t&quot;</span>,now.Year())</span><br><span class="line">fmt.Printf(<span class="string">&quot;月：%v\t&quot;</span>,<span class="type">int</span>(now.Month()))</span><br><span class="line">fmt.Printf(<span class="string">&quot;日：%v\t&quot;</span>,now.Day())</span><br><span class="line">fmt.Printf(<span class="string">&quot;时：%v\t&quot;</span>,now.Hour())</span><br><span class="line">fmt.Printf(<span class="string">&quot;分：%v\t&quot;</span>,now.Minute())</span><br><span class="line">fmt.Printf(<span class="string">&quot;秒：%v\t&quot;</span>,now.Second())</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="日期的格式化"><a href="#日期的格式化" class="headerlink" title="日期的格式化"></a>日期的格式化</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fmt.Printf(<span class="string">&quot;获取当前年月日: %d-%d-%d 时分秒: %d:%d:%d \n&quot;</span>,now.Year(),<span class="type">int</span>(now.Month()),now.Day(),now.Hour(),now.Minute(),now.Second())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fmt.Println(now.Format(<span class="string">&quot;2006-01-02 15:04:05&quot;</span>))</span><br><span class="line">这里<span class="number">2006</span>的时间是固定</span><br></pre></td></tr></table></figure><h3 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h3><h4 id="len函数"><a href="#len函数" class="headerlink" title="len函数"></a>len函数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str := <span class="string">&quot;beihai&quot;</span></span><br><span class="line"><span class="built_in">println</span>(<span class="built_in">len</span>(str))<span class="comment">// 6</span></span><br></pre></td></tr></table></figure><h4 id="new函数"><a href="#new函数" class="headerlink" title="new函数"></a>new函数</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">num := <span class="built_in">new</span>(<span class="type">int</span>)</span><br><span class="line">fmt.Printf(<span class="string">&quot;num的类型:%T,num的值是:%v,num的地址:%v,num指针指向的值是:%v&quot;</span>,</span><br><span class="line">num,num,&amp;num,*num)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">运行结果：</span></span><br><span class="line"><span class="comment">num的类型:*int,num的值是:0xc00000e0a8,num的地址:0xc00000a028,num指针指向的值是:0</span></span><br><span class="line"><span class="comment">值是:0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="四、包"><a href="#四、包" class="headerlink" title="四、包"></a>四、包</h2><h3 id="包产生的原因"><a href="#包产生的原因" class="headerlink" title="包产生的原因"></a>包产生的原因</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="number">1</span>).我们不肯能将所有函数放在同一个源文件中，可以分门别类将函数放在不同的源文件中</span><br><span class="line"><span class="number">1.</span> <span class="comment">//main.go 主要用于主函数入口</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span> <span class="comment">// utils.go 专门定义一些工具函数，让其他文件来调用</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span> <span class="comment">// db.go 专门定义对数据库操作的函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getConnection</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>).解决同名问题，两人都想定义一个同名函数，不能放在同一文件下，这时可以用不同包来表示</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h3><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20230312095852147.png" alt="image-20230312095852147"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里go.mod 需要使用 go mod init crm来创建</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.go</span></span><br><span class="line"><span class="keyword">package</span> main<span class="comment">// 1.package进行包的声明，建议：包声明和所在包同名</span></span><br><span class="line"><span class="comment">// 2.main包是程序的入口包《一般main函数会放在这个包下</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;crm/dbutils&quot;</span></span><br><span class="line"><span class="string">&quot;crm/calutils&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;你好,这是main函数的执行&quot;</span>)</span><br><span class="line">dbutils.GetConn()</span><br><span class="line">aaa.Add()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dbutils</span></span><br><span class="line"><span class="keyword">package</span> dbutils</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetConn</span><span class="params">()</span></span> &#123;<span class="comment">// 首字母大写，可以被其他包访问</span></span><br><span class="line">fmt.Println(<span class="string">&quot;执行了dbutils包下的getConn函数的执行&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// aaa.go</span></span><br><span class="line"><span class="keyword">package</span> aaa</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Add</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;add 函数被执行了&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// go mod</span></span><br><span class="line">module crm</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.20</span></span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">你好,这是main函数的执行</span><br><span class="line">执行了dbutils包下的getConn函数的执行</span><br><span class="line">add 函数被执行了</span><br></pre></td></tr></table></figure><h3 id="包别名"><a href="#包别名" class="headerlink" title="包别名"></a>包别名</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main<span class="comment">// 1.package进行包的声明，建议：包声明和所在包同名</span></span><br><span class="line"><span class="comment">// 2.main包是程序的入口包《一般main函数会放在这个包下</span></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;crm/dbutils&quot;</span></span><br><span class="line">test <span class="string">&quot;crm/calutils&quot;</span> <span class="comment">// ！！！！！！！！！</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;你好,这是main函数的执行&quot;</span>)</span><br><span class="line">dbutils.GetConn()</span><br><span class="line">test.Add() <span class="comment">// ！！！！！！！！！</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">闭包就是一个函数和与其相关的引用环境组合的一个整体 ，只是这个函数引入外界的变量/参数</span><br><span class="line">闭包的本质：</span><br><span class="line">闭包本质是一个匿名函数，只是这个函数引入外界的变量/参数</span><br><span class="line">匿名函数+引用的变量/参数 = 闭包</span><br></pre></td></tr></table></figure><h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> 匿名函数中引用的那个变量会一直保存在内存中，可以一直使用 ---&gt; 对内存消耗巨大</span><br><span class="line"> 跟普通的方法可不一样</span><br><span class="line"> 例如：</span><br><span class="line"> <span class="comment">// 普通方法每次调用都不能累加</span></span><br><span class="line"> <span class="function"><span class="keyword">func</span> <span class="title">getSum</span><span class="params">(num1 <span class="type">int</span>)</span></span> (<span class="type">int</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> sum <span class="type">int</span> = <span class="number">0</span></span><br><span class="line">sum += num1</span><br><span class="line"><span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 闭包方法可以累加</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSum</span><span class="params">()</span></span> <span class="function"><span class="keyword">func</span> <span class="params">(<span class="type">int</span>)</span></span> (<span class="type">int</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> sum <span class="type">int</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span> <span class="params">(num <span class="type">int</span>)</span></span> <span class="type">int</span> &#123;</span><br><span class="line">        sum = sum + num</span><br><span class="line">        <span class="keyword">return</span> sum</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="五、错误处理"><a href="#五、错误处理" class="headerlink" title="五、错误处理"></a>五、错误处理</h2><p>捕获机制</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">defer + recover</span><br></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">test()</span><br><span class="line">fmt.Println(<span class="string">&quot;逻辑成功，开始执行下面代码......&quot;</span>)</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="number">5</span> + <span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// 调用recover内置函数，可以捕获错误：</span></span><br><span class="line">err := <span class="built_in">recover</span>()</span><br><span class="line"><span class="comment">// 如果没有捕获错误，返回值为零值: nil</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span>&#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;错误已经捕获&quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;err是: &quot;</span>, err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;()</span><br><span class="line">num1 := <span class="number">10</span></span><br><span class="line">num2 := <span class="number">0</span><span class="comment">//这里是错误的</span></span><br><span class="line">result := num1 / num2</span><br><span class="line">fmt.Println(result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">错误已经捕获</span></span><br><span class="line"><span class="comment">err是:  runtime error: integer divide by zero</span></span><br><span class="line"><span class="comment">逻辑成功，开始执行下面代码......</span></span><br><span class="line"><span class="comment">12</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h4 id="自定义错误"><a href="#自定义错误" class="headerlink" title="自定义错误"></a>自定义错误</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">error</span>包下的New函数</span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;errors&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">err := test()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(<span class="string">&quot;自定义错误: &quot;</span>,err)</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(<span class="string">&quot;上面的除法操作执行成功...&quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;正常执行下面的逻辑...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> (err <span class="type">error</span>) &#123;</span><br><span class="line">num1 := <span class="number">10</span></span><br><span class="line">num2 := <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> num2 == <span class="number">0</span> &#123;</span><br><span class="line"><span class="comment">//抛出自定以错误：</span></span><br><span class="line"><span class="keyword">return</span> errors.New(<span class="string">&quot;除数不能为0哦~~~&quot;</span>)</span><br><span class="line">        <span class="built_in">panic</span>(err)</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">result := num1 / num2</span><br><span class="line">fmt.Println(result)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>数据抽取</title>
      <link href="/2022/12/10/%E6%95%B0%E6%8D%AE%E6%8A%BD%E5%8F%96/"/>
      <url>/2022/12/10/%E6%95%B0%E6%8D%AE%E6%8A%BD%E5%8F%96/</url>
      
        <content type="html"><![CDATA[<h1 id="数据抽取"><a href="#数据抽取" class="headerlink" title="数据抽取"></a>数据抽取</h1><p>数据抽取分为全量数据抽取，和增量数据抽取<br>全量就是讲源数据全部抽取到目标数据地，<br>增量数据抽取就是有条件性的抽取，<br>这里抽取时候可以用到一个工具Sqoop</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">在 hive 里面截图的时候最好设置上</span><br><span class="line"></span><br><span class="line"># 仅上面一行输出的是表名.列名</span><br><span class="line"><span class="keyword">set</span> hive.cli.print.header<span class="operator">=</span><span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"># 不显示表名，只显示列名</span><br><span class="line"><span class="keyword">set</span> hive.resultset.use.unique.column.names<span class="operator">=</span><span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"># 显示当前数据库</span><br><span class="line"><span class="keyword">set</span> hive.cli.print.current.db <span class="operator">=</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="一-利用Sqoop抽取"><a href="#一-利用Sqoop抽取" class="headerlink" title="一.利用Sqoop抽取"></a>一.利用Sqoop抽取</h2><h3 id="全量数据抽取："><a href="#全量数据抽取：" class="headerlink" title="全量数据抽取："></a>全量数据抽取：</h3><p>对于全量抽取来说一点也不难，但是非常容易出错，我有几个经常忘记的点：</p><ul><li>不要忘记增加targrt-dir这个配置项,，这个主要作用是sqoop先传到hdfs上面然后从hdfs导入到hive表中，所以这项不能掉</li><li>driver配置项需要加上</li></ul><p><strong>抽取shtd_store库中CUSTOMER的全量数据进入Hive的ods库中表customer。字段排序、类型不变，同时添加静态分区，分区字段类型为String，且值为当前比赛日的前一天日期（分区字段格式为yyyyMMdd）。并在hive cli执行show partitions ods.customer命令，将结果截图复制粘贴至对应报告中</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">bin<span class="operator">/</span>sqoop import \</span><br><span class="line"><span class="comment">--connect jdbc:mysql://bigdata1:3306/shtd_store \</span></span><br><span class="line"><span class="comment">--driver com.mysql.jdbc.Driver \</span></span><br><span class="line"><span class="comment">--username root \</span></span><br><span class="line"><span class="comment">--password 123456 \</span></span><br><span class="line"><span class="comment">--table CUSTOMER \</span></span><br><span class="line"><span class="comment">--fields-terminated-by &#x27;|&#x27; \</span></span><br><span class="line"><span class="comment">--target-dir /sqoop/o1 \</span></span><br><span class="line"><span class="comment">--hive-import \</span></span><br><span class="line"><span class="comment">--hive-overwrite \</span></span><br><span class="line"><span class="comment">--hive-table &#x27;ods.customer&#x27; \</span></span><br><span class="line"><span class="comment">--hive-partition-key etldate \</span></span><br><span class="line"><span class="comment">--hive-partition-value 20221209 \</span></span><br><span class="line"><span class="comment">--m 1</span></span><br><span class="line"></span><br><span class="line">bin<span class="operator">/</span>sqoop import \</span><br><span class="line"><span class="comment">--connect jdbc:mysql://bigdata1:3306/shtd_store \</span></span><br><span class="line"><span class="comment">--driver com.mysql.jdbc.Driver \</span></span><br><span class="line"><span class="comment">--username root \</span></span><br><span class="line"><span class="comment">--password 123456 \</span></span><br><span class="line"><span class="comment">--table NATION \</span></span><br><span class="line"><span class="comment">--fields-terminated-by &#x27;|&#x27; \</span></span><br><span class="line"><span class="comment">--target-dir /sqoop/o1 \</span></span><br><span class="line"><span class="comment">--hive-import \</span></span><br><span class="line"><span class="comment">--hive-overwrite \</span></span><br><span class="line"><span class="comment">--hive-table &#x27;ods.NATION&#x27; \</span></span><br><span class="line"><span class="comment">--hive-partition-key etldate \</span></span><br><span class="line"><span class="comment">--hive-partition-value 20221209 \</span></span><br><span class="line"><span class="comment">--m 1</span></span><br></pre></td></tr></table></figure><p>总体来说不难，但是要注意细节别看错题目直接忽略了增量抽取，这一部分我用spark做的时候总会出现错误，大部分是因为spark3.0有点不稳定，比赛最好还是sqoop来抽取吧</p><h3 id="增量数据抽取"><a href="#增量数据抽取" class="headerlink" title="增量数据抽取"></a>增量数据抽取</h3><p>这部分有点难度，主要还是练的少，平时嫌麻烦就没有往hive表里导数据，这里可以先用sqoop往hive原表里面搞点原始数据，这里hive里面的原表应该有分区这里一律设置为etldate&#x3D;20221210</p><p>其实最好用的方法还是用sparksql来写，但是打包上集群太麻烦了</p><h4 id="第一种动态分区并设置字段内容"><a href="#第一种动态分区并设置字段内容" class="headerlink" title="第一种动态分区并设置字段内容"></a>第一种动态分区并设置字段内容</h4><blockquote><p><strong>抽取shtd_store库中ORDERS的增量数据进入Hive的ods库中表orders，要求只取1996年07月02及之后的数据（包括1996年07月02），对比MySQL和Hive中的表的ORDERKEY大小，根据ORDERS表中ORDERKEY作为增量字段，只将新增的数据抽入，字段类型不变，同时添加动态分区，分区字段类型为String，且值为ORDERDATE字段的内容（ORDERDATE的格式为yyyy-MM-dd，分区字段格式为yyyyMMdd），并在hive cli执行select count(distinct(etldate)) from  ods.orders命令，将Sqoop提交命令及hive cli的执行结果分别截图复制粘贴至对应报告中；</strong></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">一.先伪造原始数据</span><br><span class="line"></span><br><span class="line">这里假设orders的增量字段orderkey为<span class="number">800000</span>，所以要先把<span class="number">800000</span>之前的数据抽取到hive中</span><br><span class="line">这里别忘了把orderkey转换成<span class="type">int</span>类型要不然默认是string类型就完蛋了，全抽过去了</span><br><span class="line"></span><br><span class="line">bin<span class="operator">/</span>sqoop import \</span><br><span class="line"><span class="comment">--connect jdbc:mysql://bigdata1:3306/shtd_store \</span></span><br><span class="line"><span class="comment">--username root \</span></span><br><span class="line"><span class="comment">--password 123456 \</span></span><br><span class="line"><span class="comment">--driver com.mysql.jdbc.Driver \</span></span><br><span class="line"><span class="comment">--target-dir /sqoop/o1 \</span></span><br><span class="line"><span class="comment">--query &#x27;select * from ORDERS where cast(ORDERKEY as signed integer) &lt;= 800000 and $CONDITIONS&#x27; \</span></span><br><span class="line"><span class="comment">--hive-import \</span></span><br><span class="line"><span class="comment">--hive-overwrite \</span></span><br><span class="line"><span class="comment">--hive-table &#x27;ods.orders&#x27; \</span></span><br><span class="line"><span class="comment">--hive-partition-key etldate \</span></span><br><span class="line"><span class="comment">--hive-partition-value 20221210 \</span></span><br><span class="line"><span class="comment">--m 1</span></span><br><span class="line"></span><br><span class="line">完成了原始数据的创建了这里需要第二部分</span><br><span class="line">由于比赛的时候是原表有数据，所以先进行逆向排序，查看orderkey最大值为多少，以他为增量最大字段</span><br><span class="line">hive (ods)<span class="operator">&gt;</span> <span class="keyword">select</span> orderkey <span class="keyword">from</span> orders <span class="keyword">order</span> <span class="keyword">by</span> orderkey <span class="keyword">desc</span> limit <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">二.增量抽取</span><br><span class="line">这里有几点重要：</span><br><span class="line"><span class="number">1.</span>添加动态分区的时候，需要新建一个middle_orders增加一列etldate,这一列etldate是</span><br><span class="line">orderdate 并且把格式转成 yyyyMMdd  并把orderkey<span class="operator">&gt;</span><span class="number">800000</span>的数据导入middle_orders</span><br><span class="line"></span><br><span class="line">同时添加动态分区，分区字段类型为String，且值为ORDERDATE字段的内容（ORDERDATE的格式为yyyy<span class="operator">-</span>MM<span class="operator">-</span>dd，分区字段格式为yyyyMMdd）</span><br><span class="line"></span><br><span class="line">(<span class="number">1</span>).先建一个中间表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> middle_orders</span><br><span class="line">(</span><br><span class="line">orderkey string, </span><br><span class="line">custkey string,</span><br><span class="line">orderstatus string,</span><br><span class="line">totalprice string,</span><br><span class="line">orderdate string,</span><br><span class="line">orderpriority string, </span><br><span class="line">clerk string,</span><br><span class="line">shippriority string,</span><br><span class="line">comment string,</span><br><span class="line">etldate string</span><br><span class="line">) stored <span class="keyword">as</span> textfile</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>).往中间表里面导入数据</span><br><span class="line">bin<span class="operator">/</span>sqoop import \</span><br><span class="line"><span class="comment">--connect jdbc:mysql://bigdata1:3306/shtd_store \</span></span><br><span class="line"><span class="comment">--username root \</span></span><br><span class="line"><span class="comment">--password 123456 \</span></span><br><span class="line"><span class="comment">--driver com.mysql.jdbc.Driver \</span></span><br><span class="line"><span class="comment">--target-dir /sqoop/o1 \</span></span><br><span class="line"><span class="comment">--query &#x27;select *, replace(ORDERDATE, &quot;-&quot;, &quot;&quot;) from ORDERS where cast(ORDERKEY as SIGNED INTEGER) &gt; 800000 and ORDERDATE &gt; &quot;1996-07-02&quot; and $CONDITIONS&#x27; \</span></span><br><span class="line"><span class="comment">--hive-import \</span></span><br><span class="line"><span class="comment">--hive-overwrite \</span></span><br><span class="line"><span class="comment">--hive-table ods.middle_orders \</span></span><br><span class="line"><span class="comment">--m 1</span></span><br><span class="line"></span><br><span class="line">(<span class="number">3</span>).重点一步开启动态分区，为导入分区表做准备</span><br><span class="line"><span class="keyword">set</span> hive.exec.dynamic.partition<span class="operator">=</span><span class="literal">true</span>;</span><br><span class="line"><span class="keyword">set</span> hive.exec.dynamic.partition.mode<span class="operator">=</span><span class="literal">false</span>;</span><br><span class="line"><span class="keyword">set</span> hive.exec.max.dynamic.partitions<span class="operator">=</span><span class="number">90000</span>;</span><br><span class="line"><span class="keyword">set</span> hive.exec.max.dynamic.partitions.pernode<span class="operator">=</span><span class="number">90000</span>;</span><br><span class="line"></span><br><span class="line">(<span class="number">4</span>).新增数据到orders</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> orders <span class="keyword">partition</span>(etldate) <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> middle_orders;</span><br><span class="line"></span><br><span class="line">(<span class="number">5</span>).求<span class="keyword">distinct</span></span><br><span class="line">hive (ods)<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span>(etldate)) <span class="keyword">from</span> ods.orders;</span><br></pre></td></tr></table></figure><h4 id="第二种直接增量导入"><a href="#第二种直接增量导入" class="headerlink" title="第二种直接增量导入"></a>第二种直接增量导入</h4><blockquote><p> 抽取shtd_store库中LINEITEM的增量数据进入Hive的ods库中表lineitem，根据LINEITEM表中orderkey作为增量字段，只将新增的数据抽入，字段类型不变，同时添加静态分区，分区字段类型为String，且值为当前比赛日的前一天日期（分区字段格式为yyyyMMdd）。并在hive cli执行show partitions ods.lineitem命令，将结果截图复制粘贴至对应报告中。</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>伪造源数据</span><br><span class="line">先把orderkey<span class="operator">&lt;=</span><span class="number">5992002</span>导入分区etldate<span class="operator">=</span><span class="number">20221210</span></span><br><span class="line">bin<span class="operator">/</span>sqoop import \</span><br><span class="line"><span class="comment">--connect jdbc:mysql://bigdata1:3306/shtd_store \</span></span><br><span class="line"><span class="comment">--username root \</span></span><br><span class="line"><span class="comment">--password 123456 \</span></span><br><span class="line"><span class="comment">--driver com.mysql.jdbc.Driver \</span></span><br><span class="line"><span class="comment">--target-dir /sqoop/o3 \</span></span><br><span class="line"><span class="comment">--fields-terminated-by &#x27;|&#x27; \</span></span><br><span class="line"><span class="comment">--query &#x27;select * from LINEITEM where cast(ORDERKEY as SIGNED INTEGER) &lt;= 5992002 and $CONDITIONS&#x27; \</span></span><br><span class="line"><span class="comment">--hive-import \</span></span><br><span class="line"><span class="comment">--hive-overwrite \</span></span><br><span class="line"><span class="comment">--hive-table &#x27;ods.lineitem&#x27; \</span></span><br><span class="line"><span class="comment">--hive-partition-key etldate \</span></span><br><span class="line"><span class="comment">--hive-partition-value &#x27;20221210&#x27; \</span></span><br><span class="line"><span class="comment">--m 1</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>导入新增数据</span><br><span class="line">bin<span class="operator">/</span>sqoop import \</span><br><span class="line"><span class="comment">--connect jdbc:mysql://bigdata1:3306/shtd_store \</span></span><br><span class="line"><span class="comment">--username root \</span></span><br><span class="line"><span class="comment">--password 123456 \</span></span><br><span class="line"><span class="comment">--driver com.mysql.jdbc.Driver \</span></span><br><span class="line"><span class="comment">--target-dir /sqoop/o3 \</span></span><br><span class="line"><span class="comment">--fields-terminated-by &#x27;|&#x27; \</span></span><br><span class="line"><span class="comment">--query &#x27;select * from LINEITEM where cast(ORDERKEY as SIGNED INTEGER) &gt; 5992002 and $CONDITIONS&#x27; \</span></span><br><span class="line"><span class="comment">--hive-import \</span></span><br><span class="line"><span class="comment">--hive-overwrite \</span></span><br><span class="line"><span class="comment">--hive-table &#x27;ods.lineitem&#x27; \</span></span><br><span class="line"><span class="comment">--hive-partition-key etldate \</span></span><br><span class="line"><span class="comment">--hive-partition-value &#x27;20221209&#x27; \</span></span><br><span class="line"><span class="comment">--m 1</span></span><br></pre></td></tr></table></figure><p>总结一下增量抽取，需要思路清晰，把题目看清楚了有的需要添加动态分区，分区字段要新建中间表再添加，另外重要一点是<em><strong>cast(ORDERKEY as SIGNED INTEGER)</strong></em> 这里是SIGNED INTEGER ，replace(ORDERDATE, “-“, “”)</p><h2 id="二-利用SparkSql抽取"><a href="#二-利用SparkSql抽取" class="headerlink" title="二.利用SparkSql抽取"></a>二.利用SparkSql抽取</h2><h3 id="全量数据抽取：-1"><a href="#全量数据抽取：-1" class="headerlink" title="全量数据抽取："></a>全量数据抽取：</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> dask01</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.<span class="type">SimpleDateFormat</span></span><br><span class="line"><span class="keyword">import</span> java.util.&#123;<span class="type">Date</span>, <span class="type">Properties</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">task1_1</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark: <span class="type">SparkSession</span> = <span class="type">SparkSession</span>.builder()</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.warehouse.dir&quot;</span>, <span class="string">&quot;hdfs://bigdata1:9000/user/hive/warehouse&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.legacy.createHiveTableByDefault&quot;</span>, <span class="string">&quot;false&quot;</span>)</span><br><span class="line">      .config(<span class="string">&quot;spark.sql.legacy.timeParserPolicy&quot;</span>, <span class="string">&quot;LEGACY&quot;</span>)</span><br><span class="line">      .master(<span class="string">&quot;local[*]&quot;</span>)</span><br><span class="line">      .appName(<span class="string">&quot;task1_1&quot;</span>)</span><br><span class="line">      .enableHiveSupport()</span><br><span class="line">      .getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.sql</span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> prop = <span class="keyword">new</span> <span class="type">Properties</span>()</span><br><span class="line">    <span class="keyword">val</span> url = <span class="string">&quot;jdbc:mysqL://bigdata1:3306/shtd_store?characterEncoding=utf8&amp;useSSL=false&quot;</span></span><br><span class="line">    prop.setProperty(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;root&quot;</span>)</span><br><span class="line">    prop.setProperty(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;123456&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> simpleDateFormat = <span class="keyword">new</span> <span class="type">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> date = <span class="keyword">new</span> <span class="type">Date</span>()</span><br><span class="line">    <span class="keyword">val</span> timeNow: <span class="type">String</span> = simpleDateFormat.format(date)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> timeStr = <span class="string">&quot;20220413&quot;</span></span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;use ods&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;set hive.exec.dynamic.partition=true&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">&quot;set hive.exec.dynamic.partition.mode=nonstrict&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">&quot;set hive.exec.max.dynamic.partitions=80000&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">&quot;set hive.exec.max.dynamic.partitions.pernode=80000&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;truncate table ods.customer&quot;</span>)</span><br><span class="line">    spark.read.jdbc(url,<span class="string">&quot;CUSTOMER&quot;</span>,prop).createOrReplaceTempView(<span class="string">&quot;t1&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">s&quot;insert overwrite table ods.customer partition(etldate=&#x27;<span class="subst">$timeStr</span>&#x27;) select * from t1&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;truncate table ods.nation&quot;</span>)</span><br><span class="line">    spark.read.jdbc(url,<span class="string">&quot;NATION&quot;</span>,prop).createOrReplaceTempView(<span class="string">&quot;t2&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">s&quot;insert overwrite table ods.nation partition(etldate=&#x27;<span class="subst">$timeStr</span>&#x27;) select * from t2&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;truncate table ods.part&quot;</span>)</span><br><span class="line">    spark.read.jdbc(url,<span class="string">&quot;PART&quot;</span>,prop).createOrReplaceTempView(<span class="string">&quot;t3&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">s&quot;insert overwrite table ods.part partition(etldate=&#x27;<span class="subst">$timeStr</span>&#x27;) select * from t3&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;truncate table ods.partsupp&quot;</span>)</span><br><span class="line">    spark.read.jdbc(url,<span class="string">&quot;PARTSUPP&quot;</span>,prop).createOrReplaceTempView(<span class="string">&quot;t4&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">s&quot;insert overwrite table ods.partsupp partition(etldate=&#x27;<span class="subst">$timeStr</span>&#x27;) select * from t4&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;truncate table ods.region&quot;</span>)</span><br><span class="line">    spark.read.jdbc(url,<span class="string">&quot;REGION&quot;</span>,prop).createOrReplaceTempView(<span class="string">&quot;t5&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">s&quot;insert overwrite table ods.region partition(etldate=&#x27;<span class="subst">$timeStr</span>&#x27;) select * from t5&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;truncate table ods.supplier&quot;</span>)</span><br><span class="line">    spark.read.jdbc(url,<span class="string">&quot;SUPPLIER&quot;</span>,prop).createOrReplaceTempView(<span class="string">&quot;t4&quot;</span>)</span><br><span class="line">    spark.sql(<span class="string">s&quot;insert overwrite table ods.supplier partition(etldate=&#x27;<span class="subst">$timeStr</span>&#x27;) select * from t4&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;insert into table ods.orders partition(etldate) select * from middle_orders&quot;</span>)</span><br><span class="line"></span><br><span class="line">    spark.sql(<span class="string">&quot;select count(distinct(etldate)) from ods.orders&quot;</span>).show()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 工作室 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Flink</title>
      <link href="/2022/12/08/Flink/"/>
      <url>/2022/12/08/Flink/</url>
      
        <content type="html"><![CDATA[<h1 id="Flink"><a href="#Flink" class="headerlink" title="Flink"></a>Flink</h1><p>处理实时数据流，对时间的要求高，所以经常用到开窗等一系列的操作</p><h1 id="有界流"><a href="#有界流" class="headerlink" title="有界流"></a>有界流</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">Flink</span>.<span class="type">WordCount</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.flink.streaming.api.scala.&#123;<span class="type">DataStream</span>, <span class="type">StreamExecutionEnvironment</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.scala._</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">StreamWordCount</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="comment">//1.创建流式执行环境</span></span><br><span class="line">    <span class="keyword">val</span> env: <span class="type">StreamExecutionEnvironment</span> = <span class="type">StreamExecutionEnvironment</span>.getExecutionEnvironment</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.读取文件</span></span><br><span class="line">    <span class="keyword">val</span> lineDataStream: <span class="type">DataStream</span>[<span class="type">String</span>] = env.readTextFile(<span class="string">&quot;input/words.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.运算</span></span><br><span class="line">    <span class="keyword">val</span> result: <span class="type">DataStream</span>[(<span class="type">String</span>, <span class="type">Int</span>)] = lineDataStream.flatMap(_.split(<span class="string">&quot; &quot;</span>)).map((_, <span class="number">1</span>)).keyBy(_._1).sum(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.结果</span></span><br><span class="line">    result.print()</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.执行任务</span></span><br><span class="line">    env.execute()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="无界流"><a href="#无界流" class="headerlink" title="无界流"></a>无界流</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">Flink</span>.<span class="type">WordCount</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.java.utils.<span class="type">ParameterTool</span></span><br><span class="line"><span class="keyword">import</span> org.apache.flink.streaming.api.scala._</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">TrueStreamWordCount</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> env: <span class="type">StreamExecutionEnvironment</span> = <span class="type">StreamExecutionEnvironment</span>.getExecutionEnvironment</span><br><span class="line"></span><br><span class="line">    <span class="comment">//读取socket流</span></span><br><span class="line"><span class="comment">//    val lineDataStream: DataStream[String] = env.socketTextStream(&quot;master&quot;, 44444)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> parameterTool: <span class="type">ParameterTool</span> = <span class="type">ParameterTool</span>.fromArgs(args)</span><br><span class="line">    <span class="keyword">val</span> hostname: <span class="type">String</span> = parameterTool.get(<span class="string">&quot;host&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> port: <span class="type">Int</span> = parameterTool.getInt(<span class="string">&quot;port&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> lineDataStream: <span class="type">DataStream</span>[<span class="type">String</span>] = env.socketTextStream(hostname, port)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    lineDataStream.flatMap(_.split(<span class="string">&quot; &quot;</span>)).map((_,<span class="number">1</span>)).keyBy(_._1).sum(<span class="number">1</span>).print()</span><br><span class="line"></span><br><span class="line">    env.execute()</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20221114093156759.png" alt="image-20221114093156759"></p><h1 id="Flink启动和停止"><a href="#Flink启动和停止" class="headerlink" title="Flink启动和停止"></a>Flink启动和停止</h1><h2 id="本地模式"><a href="#本地模式" class="headerlink" title="本地模式"></a>本地模式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">启动:bin/start-cluster.sh</span><br><span class="line">停止:bin/stop-cluster.sh </span><br><span class="line"></span><br><span class="line">[root@master flink]# ./bin/flink run -m master:8081 -c Flink.WordCount.TrueStreamWordCount -p 2 ./hivespark-1.0-SNAPSHOT.jar --host master --port 44444</span><br><span class="line">Job has been submitted with JobID 5889aea585779ac98350b3ad17a9e02d</span><br><span class="line"></span><br><span class="line">查看作业</span><br><span class="line">1.添加job作业编号</span><br><span class="line">[root@master flink]# ./bin/flink list 5889aea585779ac98350b3ad17a9e02d</span><br><span class="line">Waiting for response...</span><br><span class="line">------------------ Running/Restarting Jobs -------------------</span><br><span class="line">14.11.2022 10:33:54 : 5889aea585779ac98350b3ad17a9e02d : Flink Streaming Job (RUNNING)</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">No scheduled jobs.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2.直接查看</span><br><span class="line">[root@master flink]# ./bin/flink list</span><br><span class="line">Waiting for response...</span><br><span class="line">------------------ Running/Restarting Jobs -------------------</span><br><span class="line">14.11.2022 10:33:54 : 5889aea585779ac98350b3ad17a9e02d : Flink Streaming Job (RUNNING)</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">No scheduled jobs.</span><br><span class="line"></span><br><span class="line">3.查看所有的包括之前取消的</span><br><span class="line">[root@master flink]# ./bin/flink list -a</span><br><span class="line">Waiting for response...</span><br><span class="line">------------------ Running/Restarting Jobs -------------------</span><br><span class="line">14.11.2022 10:33:54 : 5889aea585779ac98350b3ad17a9e02d : Flink Streaming Job (RUNNING)</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">No scheduled jobs.</span><br><span class="line">---------------------- Terminated Jobs -----------------------</span><br><span class="line">14.11.2022 10:23:57 : 19a87da39b618b6053bb496d5ba5b2ee : Flink Streaming Job (CANCELED)</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">4.关闭作业</span><br><span class="line">[root@master flink]# ./bin/flink cancel 5889aea585779ac98350b3ad17a9e02d</span><br><span class="line">Cancelling job 5889aea585779ac98350b3ad17a9e02d.</span><br><span class="line">Cancelled job 5889aea585779ac98350b3ad17a9e02d.</span><br></pre></td></tr></table></figure><h2 id="Yarn部署"><a href="#Yarn部署" class="headerlink" title="Yarn部署"></a>Yarn部署</h2><h3 id="一-yarn的会话模式"><a href="#一-yarn的会话模式" class="headerlink" title="(一).yarn的会话模式"></a>(一).yarn的会话模式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">启动</span><br><span class="line">bin/yarn-session.sh -nm test -d</span><br><span class="line"></span><br><span class="line">建立job</span><br><span class="line">./bin/flink run -c Flink.WordCount.TrueStreamWordCount -p 2 ./hivespark-1.0-SNAPSHOT.jar --host master --port 44444</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Flume配置</title>
      <link href="/2022/12/08/Flume%E9%85%8D%E7%BD%AE/"/>
      <url>/2022/12/08/Flume%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="Flume配置"><a href="#Flume配置" class="headerlink" title="Flume配置"></a>Flume配置</h1><p> flume的数据采集部分做的很好，可以定制很多数据源，减少开发量。所以比较流行flume+kafka模式，如果为了利用flume写hdfs的能力，也可以采用kafka+flume的方式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">模板：</span><br><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a1.sources.r1.type = </span><br></pre></td></tr></table></figure><h2 id="一-netcat连接"><a href="#一-netcat连接" class="headerlink" title="(一).netcat连接"></a>(一).netcat连接</h2><h3 id="1-启动zook"><a href="#1-启动zook" class="headerlink" title="1.启动zook"></a>1.启动zook</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./zkServer.sh start</span><br></pre></td></tr></table></figure><h3 id="2-配置flume文件-flume-netcat-logger-conf"><a href="#2-配置flume文件-flume-netcat-logger-conf" class="headerlink" title="2.配置flume文件(flume-netcat-logger.conf)"></a>2.配置flume文件(flume-netcat-logger.conf)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 44444</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000   (channel中可存放多少个Event)</span><br><span class="line">a1.channels.c1.transactionCapacity = 100 (putList和takeList的容量)</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br></pre></td></tr></table></figure><h3 id="3-开启flume监听端口"><a href="#3-开启flume监听端口" class="headerlink" title="3.开启flume监听端口"></a>3.开启flume监听端口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flume&gt; bin/flume-ng agent --conf conf/ --name a1 --conf-file job/flume-netcat-logger.conf -Dflume-root.logger=INFO,console</span><br></pre></td></tr></table></figure><h3 id="4-开启客户端消费"><a href="#4-开启客户端消费" class="headerlink" title="4.开启客户端消费"></a>4.开启客户端消费</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc localhost 44444nc -lk xxx</span><br></pre></td></tr></table></figure><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20221104191834018.png" alt="image-20221104191834018"></p><h3 id="5-如果报错就是后台会有多个Application杀掉就可"><a href="#5-如果报错就是后台会有多个Application杀掉就可" class="headerlink" title="5.如果报错就是后台会有多个Application杀掉就可"></a>5.如果报错就是后台会有多个Application杀掉就可</h3><h2 id="二-实时监控HIVE日志-gt-HDFS"><a href="#二-实时监控HIVE日志-gt-HDFS" class="headerlink" title="(二).实时监控HIVE日志-&gt;HDFS"></a>(二).实时监控HIVE日志-&gt;HDFS</h2><h3 id="1-启动"><a href="#1-启动" class="headerlink" title="1.启动"></a>1.启动</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.启动zookeeper</span><br><span class="line">./zkServer.sh start</span><br><span class="line">2.启动hdfs</span><br><span class="line">hadoop&gt; sbin/start-dfs.sh</span><br><span class="line">hadoop&gt; sbin/start-yarn.sh</span><br><span class="line">3.启动hive</span><br><span class="line">hive --service metastore &amp;--&gt;启动元数据</span><br><span class="line">hive --service hiveserver2 $--&gt;启动hive2</span><br><span class="line">hive&gt;</span><br></pre></td></tr></table></figure><h3 id="2-配置flume-flume-file-hdfs-conf"><a href="#2-配置flume-flume-file-hdfs-conf" class="headerlink" title="2.配置flume(flume-file-hdfs.conf)"></a>2.配置flume(flume-file-hdfs.conf)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#Name</span><br><span class="line">a2.sources = r2</span><br><span class="line">a2.sinks = k2</span><br><span class="line">a2.channels = c2</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a2.sources.r2.type = exec</span><br><span class="line">a2.sources.r2.command = tail -F /usr/local/src/hive/logs/hive.log</span><br><span class="line">a2.sources.r2.shell = /bin/bash -c</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a2.sinks.k2.type = hdfs</span><br><span class="line">a2.sinks.k2.hdfs.path = hdfs://10.7.75.210:9000/flume/%Y%m%d/%H</span><br><span class="line">a2.sinks.k2.hdfs.filePrefix = logs-</span><br><span class="line">a2.sinks.k2.hdfs.round = true</span><br><span class="line">a2.sinks.k2.hdfs.roundValue = 1</span><br><span class="line">a2.sinks.k2.hdfs.roundUnit = hour</span><br><span class="line">a2.sinks.k2.hdfs.useLocalTimeStamp = true</span><br><span class="line">a2.sinks.k2.hdfs.batchSize = 100</span><br><span class="line">a2.sinks.k2.hdfs.fileType = DataStream</span><br><span class="line">a2.sinks.k2.hdfs.rollInterval = 60</span><br><span class="line">a2.sinks.k2.hdfs.rollSize = 134217700</span><br><span class="line">a2.sinks.k2.hdfs.rollCount = 0</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a2.channels.c2.type = memory</span><br><span class="line">a2.channels.c2.capacity = 1000</span><br><span class="line">a2.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a2.sources.r2.channels = c2</span><br><span class="line">a2.sinks.k2.channel = c2</span><br></pre></td></tr></table></figure><h2 id="三-实时监控一个文件夹上传HDFS"><a href="#三-实时监控一个文件夹上传HDFS" class="headerlink" title="(三).实时监控一个文件夹上传HDFS"></a>(三).实时监控一个文件夹上传HDFS</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#Name</span><br><span class="line">a3.sources = r3</span><br><span class="line">a3.sinks = k3</span><br><span class="line">a3.channels = c3</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a3.sources.r3.type = spooldir</span><br><span class="line">a3.sources.r3.spoolDir = /usr/local/src/flume/upload</span><br><span class="line">a3.sources.r3.fileSuffix = .COM</span><br><span class="line">a3.sources.r3.fileHeader = true</span><br><span class="line">a3.sources.r3.ignordPattern = ([^ ]*\.tmp)</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a3.sinks.k3.type = hdfs</span><br><span class="line">a3.sinks.k3.hdfs.path = hdfs://master:9000/flume/upload/%Y%m%d/%H</span><br><span class="line">a3.sinks.k3.hdfs.filePrefix = upload-</span><br><span class="line">a3.sinks.k3.hdfs.round = true</span><br><span class="line">a3.sinks.k3.hdfs.roundValue = 1</span><br><span class="line">a3.sinks.k3.hdfs.roundUnit = hour</span><br><span class="line">a3.sinks.k3.hdfs.useLocalTimeStamp = true</span><br><span class="line">a3.sinks.k3.hdfs.batchSize = 100</span><br><span class="line">a3.sinks.k3.hdfs.fileType = DataStream</span><br><span class="line">a3.sinks.k3.hdfs.rollInterval = 60</span><br><span class="line">a3.sinks.k3.hdfs.rollSize = 134217700</span><br><span class="line">a3.sinks.k3.hdfs.rollCount = 0</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a3.channels.c3.type = memory</span><br><span class="line">a3.channels.c3.capacity = 1000</span><br><span class="line">a3.channels.c3.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a3.sources.r3.channels = c3</span><br><span class="line">a3.sinks.k3.channel = c3</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="四-实时监控新增文件"><a href="#四-实时监控新增文件" class="headerlink" title="(四).实时监控新增文件"></a>(四).实时监控新增文件</h2><p>使用spooldir</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#Sources</span><br><span class="line">a1.sources.r1.type = spooldir</span><br><span class="line">a1.sources.r1.spoolDir = /usr/local/src/flume/logs/spooldir</span><br><span class="line">a1.sources.r1.fileSuffix = .COM</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a1.sinks.k1.type = hdfs</span><br><span class="line">a1.sinks.k1.hdfs.path = hdfs://master:9000/flume/%Y-%m-%d/%H</span><br><span class="line">a1.sinks.k1.hdfs.filePrefix = logs-</span><br><span class="line">a1.sinks.k1.hdfs.rollInterval = 60</span><br><span class="line">a1.sinks.k1.hdfs.rollSize = 13421770</span><br><span class="line">a1.sinks.k1.hdfs.round = true</span><br><span class="line">a1.sinks.k1.hdfs.roundValue = 1</span><br><span class="line">a1.sinks.k1.hdfs.roundUnit = hour</span><br><span class="line">a1.sinks.k1.hdfs.useLocalTimeStamp = true</span><br><span class="line">a1.sinks.k1.hdfs.rollCount = 0</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="五-实时监控多个追加文件"><a href="#五-实时监控多个追加文件" class="headerlink" title="(五).实时监控多个追加文件"></a>(五).实时监控多个追加文件</h2><p>使用taildir+正则</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#Sources</span><br><span class="line">a1.sources.r1.type = taildir</span><br><span class="line">a1.sources.r1.filegroups = f1 f2</span><br><span class="line">a1.sources.r1.filegroups.f1 = /root/job/taildir/.*\.txt</span><br><span class="line">a1.sources.r1.filegroups.f2 = /root/job/taildir/.*\.log</span><br><span class="line">a1.sources.r1.positionFile = /root/job/position/position.json</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a1.sinks.k1.type = hdfs</span><br><span class="line">a1.sinks.k1.hdfs.path = hdfs://master:9000/flume/%Y-%m-%d/%H</span><br><span class="line">a1.sinks.k1.hdfs.filePrefix = logs-</span><br><span class="line">a1.sinks.k1.hdfs.rollInterval = 60</span><br><span class="line">a1.sinks.k1.hdfs.rollSize = 13421770</span><br><span class="line">a1.sinks.k1.hdfs.round = true</span><br><span class="line">a1.sinks.k1.hdfs.roundValue = 1</span><br><span class="line">a1.sinks.k1.hdfs.roundUnit = hour</span><br><span class="line">a1.sinks.k1.hdfs.useLocalTimeStamp = true</span><br><span class="line">a1.sinks.k1.hdfs.rollCount = 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Flume高阶"><a href="#Flume高阶" class="headerlink" title="Flume高阶"></a>Flume高阶</h1><h2 id="一-复制"><a href="#一-复制" class="headerlink" title="(一).复制"></a>(一).复制</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">使用 Flume-1 监控文件变动，Flume-1 将变动内容传递给 Flume-2，Flume-2 负责存储</span><br><span class="line">到 HDFS。同时 Flume-1 将变动内容传递给 Flume-3，Flume-3 负责输出到 Local </span><br><span class="line">FileSystem。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flume1.conf</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1 k2</span><br><span class="line">a1.channels = c1 c2</span><br><span class="line"></span><br><span class="line">#Sources</span><br><span class="line">a1.sources.r1.type = taildir</span><br><span class="line">a1.sources.r1.filegroups = f1</span><br><span class="line">a1.sources.r1.filegroups.f1 = /usr/local/src/flume/job/taildir/.*\.txt</span><br><span class="line">a1.sources.r1.postitionFile =/usr/local/src/flume/job/position/position.json</span><br><span class="line"></span><br><span class="line">#Channel selector</span><br><span class="line">a1.sources.r1.selector.type = replicating</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.channels.c2.type = memory</span><br><span class="line">a1.channels.c2.capacity = 10000</span><br><span class="line">a1.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = localhost</span><br><span class="line">a1.sinks.k1.port = 7777</span><br><span class="line"></span><br><span class="line">a1.sinks.k2.type = avro</span><br><span class="line">a1.sinks.k2.hostname = localhost</span><br><span class="line">a1.sinks.k2.port = 8888</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a1.sources.r1.channels = c1 c2</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sinks.k2.channel = c2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flume2.conf</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a2.sources = r1</span><br><span class="line">a2.sinks = k1</span><br><span class="line">a2.channels = c1</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a2.sources.r1.type = avro</span><br><span class="line">a2.sources.r1.bind = localhost</span><br><span class="line">a2.sources.r1.port = 7777</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a2.sinks.k1.type = hdfs</span><br><span class="line">a2.sinks.k1.hdfs.path = hdfs://master:9000/flume/%Y-%m-%d/%H</span><br><span class="line">a2.sinks.k1.hdfs.filePrefix = beihai-</span><br><span class="line">a2.sinks.k1.hdfs.round = true</span><br><span class="line">a2.sinks.k1.hdfs.roundValue = 1</span><br><span class="line">a2.sinks.k1.hdfs.roundUnit = hour</span><br><span class="line">a2.sinks.k1.hdfs.useLocalTimeStamp = true</span><br><span class="line">a2.sinks.k1.hdfs.batchSize = 100</span><br><span class="line">a2.sinks.k1.hdfs.fileType = DataStream</span><br><span class="line">a2.sinks.k1.hdfs.rollInterval = 60</span><br><span class="line">a2.sinks.k1.hdfs.rollSize = 134217700</span><br><span class="line">a2.sinks.k1.hdfs.rollCount = 0</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a2.channels.c1.type = memory</span><br><span class="line">a2.channels.c1.capacity = 10000</span><br><span class="line">a2.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a2.sources.r1.channels = c1</span><br><span class="line">a2.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flume3.conf</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a3.sources = r1</span><br><span class="line">a3.sinks = k1</span><br><span class="line">a3.channels = c1</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a3.sources.r1.type = avro</span><br><span class="line">a3.sources.r1.bind = localhost</span><br><span class="line">a3.sources.r1.port = 8888</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a3.channels.c1.type = memory</span><br><span class="line">a3.channels.c1.capacity = 10000</span><br><span class="line">a3.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a3.sinks.k1.type = file_roll</span><br><span class="line">a3.sinks.k1.sink.directory =/usr/local/src/flume/job/fileroll</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a3.sources.r1.channels = c1</span><br><span class="line">a3.sinks.k1.channel = c1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">启动：</span><br><span class="line">bin/flume-ng agent --conf conf/ --conf-file /usr/local/src/flume/job/fuzhi/flume1.conf --name a1 -Dflume.root.logger=INFO,console</span><br></pre></td></tr></table></figure><h2 id="二-聚合"><a href="#二-聚合" class="headerlink" title="(二).聚合"></a>(二).聚合</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">hadoop102 上的 Flume-1 监控文件/opt/module/group.log，</span><br><span class="line">hadoop103 上的 Flume-2 监控某一个端口的数据流，</span><br><span class="line">Flume-1 与 Flume-2 将数据发送给 hadoop104 上的 Flume-3，Flume-3 将最终数据打印</span><br><span class="line">到控制台。</span><br><span class="line"></span><br><span class="line">flume1</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = </span><br></pre></td></tr></table></figure><h1 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">导入依赖</span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.flume<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>flume-ng-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">package Flume.interceptor;</span><br><span class="line"></span><br><span class="line">import org.apache.flume.Context;</span><br><span class="line">import org.apache.flume.Event;</span><br><span class="line">import org.apache.flume.interceptor.Interceptor;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">public class TypeInterceptor implements Interceptor &#123;</span><br><span class="line"></span><br><span class="line">    //声明一个存放事件的集合</span><br><span class="line">    private List&lt;Event&gt; addHeaderEvents;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    //初始化</span><br><span class="line">    @Override</span><br><span class="line">    public void initialize() &#123;</span><br><span class="line"></span><br><span class="line">        addHeaderEvents = new ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //单个事件拦截</span><br><span class="line">    @Override</span><br><span class="line">    public Event intercept(Event event) &#123;</span><br><span class="line"></span><br><span class="line">        //1.获取事件中的头信息</span><br><span class="line">        Map&lt;String, String&gt; headers = event.getHeaders();</span><br><span class="line"></span><br><span class="line">        //2.获取事件中的body</span><br><span class="line">        String body = new String(event.getBody());</span><br><span class="line"></span><br><span class="line">        //3.根据body中是否有hello来添加怎样的头信息</span><br><span class="line">        if (body.contains(&quot;hello&quot;))&#123;</span><br><span class="line">            //4.添加头信息</span><br><span class="line">            headers.put(&quot;type&quot;,&quot;atguigu&quot;);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            headers.put(&quot;type&quot;,&quot;beihai&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return event;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //批量事件拦截</span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;Event&gt; intercept(List&lt;Event&gt; events) &#123;</span><br><span class="line">        //1.清空集合</span><br><span class="line">        addHeaderEvents.clear();</span><br><span class="line"></span><br><span class="line">        //2.</span><br><span class="line">        for (Event event : events) &#123;</span><br><span class="line">            addHeaderEvents.add(intercept(event));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return addHeaderEvents;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void close() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static class Builder implements Interceptor.Builder&#123;</span><br><span class="line">        @Override</span><br><span class="line">        public Interceptor build() &#123;</span><br><span class="line">            return new TypeInterceptor();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void configure(Context context) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">打包发到flume的lib目录下</span><br><span class="line"></span><br><span class="line">与Kafka对接的时候</span><br><span class="line">当头文件的k为topic（first,second）时候，就会覆盖原来的first配置</span><br></pre></td></tr></table></figure><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20221112155634146.png" alt="image-20221112155634146"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">flume1</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1 k2</span><br><span class="line">a1.channels = c1 c2</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 44444</span><br><span class="line"></span><br><span class="line">#Interector</span><br><span class="line">a1.sources.r1.interceptors = i1</span><br><span class="line">a1.sources.r1.interceptors.i1.type = Flume.interceptor.TypeInterceptor$Builder</span><br><span class="line"></span><br><span class="line">#Channel Selector</span><br><span class="line">a1.sources.r1.selector.type = multiplexing</span><br><span class="line">a1.sources.r1.selector.header = type</span><br><span class="line">a1.sources.r1.selector.mapping.atguigu = c1</span><br><span class="line">a1.sources.r1.selector.mapping.beihai = c2</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = slave1</span><br><span class="line">a1.sinks.k1.port = 4141</span><br><span class="line"></span><br><span class="line">a1.sinks.k2.type= avro</span><br><span class="line">a1.sinks.k2.hostname = slave2</span><br><span class="line">a1.sinks.k2.port = 4242</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.channels.c2.type = memory</span><br><span class="line">a1.channels.c2.capacity = 1000</span><br><span class="line">a1.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a1.sources.r1.channels = c1 c2</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sinks.k2.channel = c2</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">flume2</span><br><span class="line"></span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">a1.sources.r1.type = avro</span><br><span class="line">a1.sources.r1.bind = slave1</span><br><span class="line">a1.sources.r1.port = 4141</span><br><span class="line"></span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">flume3</span><br><span class="line"></span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">a1.sources.r1.type = avro</span><br><span class="line">a1.sources.r1.bind = slave2</span><br><span class="line">a1.sources.r1.port = 4242</span><br><span class="line"></span><br><span class="line">a1.sinks.k1.type = logger</span><br><span class="line"></span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br></pre></td></tr></table></figure><h1 id="配置问题"><a href="#配置问题" class="headerlink" title="配置问题"></a>配置问题</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1.hive的日志</span><br><span class="line">先找到所在路径 /usr/local/src/hive/conf/</span><br><span class="line">(1).重新拷贝删改后缀</span><br><span class="line">cp hive-log4j2.properties-template hive-log4j2.properties</span><br><span class="line"></span><br><span class="line">(2).改变配置信息</span><br><span class="line">property.hive.log.dir = /usr/local/src/hive/logs</span><br><span class="line">property.hive.log.file = hive.log</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2.八个日志级别</span><br><span class="line">-Dflume.root.logger=INFO,console</span><br><span class="line">https://blog.csdn.net/qq_42428269/article/details/121597545</span><br><span class="line"></span><br><span class="line">3.交换文件 &quot;.flume2.conf.swp&quot; 已存在</span><br><span class="line">先使用ls -a找到隐藏的文件</span><br><span class="line">rm -f 隐藏的文件将其删除即可。</span><br></pre></td></tr></table></figure><h1 id="有意思的点："><a href="#有意思的点：" class="headerlink" title="有意思的点："></a>有意思的点：</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">(1).xshell开启缓慢</span><br><span class="line">```</span><br><span class="line">sudo vim /etc/ssh/sshd_config</span><br><span class="line">```</span><br><span class="line">将UseDNS 调为NO 不要反向解析</span><br><span class="line">(2).netcat的端口范围0~65535</span><br><span class="line">安装nc：sudo yum install -y nc</span><br><span class="line">nc手册：man nc</span><br><span class="line">(3).exec sources命令就是可以使用linux的命令来操作另外一套命令</span><br><span class="line">(4).echo &gt;&gt; 追加数据</span><br><span class="line">(5).#Bind 时候一个source可以对应多个channel所以用channels</span><br><span class="line">一个sink只能对应一个channel所以用channel</span><br><span class="line">(6).ctrl+H 替换</span><br><span class="line">(7).实时监控新文件spooldir</span><br><span class="line">(8).创建新文件touch</span><br><span class="line">(9).实时监控多个追加文件taildir</span><br><span class="line">(10).断点续传：positionFile 根据上一次所记录的数据然后直接追加添加数据这里需要添加.json的文件作为记录</span><br><span class="line">```</span><br><span class="line">/root/job/position/position.json</span><br><span class="line">```</span><br><span class="line">(11).Memory Channel 基于内存的缓存  速度快 不安全</span><br><span class="line"> File Channel 基于磁盘的缓存 速度慢 安全</span><br></pre></td></tr></table></figure><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20221107170854806.png" alt="image-20221107170854806"></p>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>SparkStreaming</title>
      <link href="/2022/12/08/SparkStreaming/"/>
      <url>/2022/12/08/SparkStreaming/</url>
      
        <content type="html"><![CDATA[<h2 id="SparkStreaming"><a href="#SparkStreaming" class="headerlink" title="SparkStreaming"></a>SparkStreaming</h2><p>准实时(秒，分钟)，微批次(多长时间处理一次)的数据处理框架</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> <span class="type">SparkStreaming</span>.<span class="type">Dstream</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.streaming.&#123;<span class="type">Seconds</span>, <span class="type">StreamingContext</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">wordcount</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//todo 创建环境</span></span><br><span class="line">    <span class="comment">//第一个参数是环境配置</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">val</span> sparkConf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;sparkStreaming&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> ssc = <span class="keyword">new</span> <span class="type">StreamingContext</span>(sparkConf, <span class="type">Seconds</span>(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">val</span> lines = ssc.socketTextStream(<span class="string">&quot;localhost&quot;</span>, <span class="number">9999</span>)</span><br><span class="line">    <span class="keyword">val</span> words = lines.flatMap(_.split(<span class="string">&quot; &quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> wordToOne = words.map((_, <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> result = wordToOne.reduceByKey(_ + _)</span><br><span class="line"></span><br><span class="line">    result.print()</span><br><span class="line"></span><br><span class="line">    ssc.start()</span><br><span class="line"></span><br><span class="line">    ssc.awaitTermination()</span><br><span class="line"></span><br><span class="line">    <span class="comment">//todo</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//发送数据：</span></span><br><span class="line">nc -lp <span class="number">9999</span>需要下载netcat软件，linux自带</span><br><span class="line">hello spark</span><br></pre></td></tr></table></figure><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">RDDStream</span> </span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</span><br><span class="line"> <span class="comment">//1.初始化 Spark 配置信息</span></span><br><span class="line"> <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setMaster(<span class="string">&quot;local[*]&quot;</span>).setAppName(<span class="string">&quot;RDDStream&quot;</span>)</span><br><span class="line"> <span class="comment">//2.初始化 SparkStreamingContext</span></span><br><span class="line"> <span class="keyword">val</span> ssc = <span class="keyword">new</span> <span class="type">StreamingContext</span>(conf, <span class="type">Seconds</span>(<span class="number">4</span>))</span><br><span class="line"> <span class="comment">//3.创建 RDD 队列</span></span><br><span class="line"> <span class="keyword">val</span> rddQueue = <span class="keyword">new</span> mutable.<span class="type">Queue</span>[<span class="type">RDD</span>[<span class="type">Int</span>]]()</span><br><span class="line"> <span class="comment">//4.创建 QueueInputDStream</span></span><br><span class="line"> <span class="keyword">val</span> inputStream = ssc.queueStream(rddQueue,oneAtATime = <span class="literal">false</span>)</span><br><span class="line"> <span class="comment">//5.处理队列中的 RDD 数据</span></span><br><span class="line"> <span class="keyword">val</span> mappedStream = inputStream.map((_,<span class="number">1</span>))</span><br><span class="line"> <span class="keyword">val</span> reducedStream = mappedStream.reduceByKey(_ + _)</span><br><span class="line"> <span class="comment">//6.打印结果</span></span><br><span class="line"> reducedStream.print()</span><br><span class="line"> <span class="comment">//7.启动任务</span></span><br><span class="line"> ssc.start()</span><br><span class="line"><span class="comment">//8.循环创建并向 RDD 队列中放入 RDD</span></span><br><span class="line"> <span class="keyword">for</span> (i &lt;- <span class="number">1</span> to <span class="number">5</span>) &#123;</span><br><span class="line"> rddQueue += ssc.sparkContext.makeRDD(<span class="number">1</span> to <span class="number">300</span>, <span class="number">10</span>)</span><br><span class="line"> <span class="type">Thread</span>.sleep(<span class="number">2000</span>)</span><br><span class="line"> &#125;</span><br><span class="line"> ssc.awaitTermination()</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-------------------------------------------</span><br><span class="line"><span class="type">Time</span>: <span class="number">1539075280000</span> ms</span><br><span class="line">-------------------------------------------</span><br><span class="line">(<span class="number">4</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">0</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">6</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">8</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">2</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">1</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">3</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">7</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">9</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">5</span>,<span class="number">60</span>)</span><br><span class="line">-------------------------------------------</span><br><span class="line"><span class="type">Time</span>: <span class="number">1539075284000</span> ms</span><br><span class="line">-------------------------------------------</span><br><span class="line">(<span class="number">4</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">0</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">6</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">8</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">2</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">1</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">3</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">7</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">9</span>,<span class="number">60</span>)</span><br><span class="line">(<span class="number">5</span>,<span class="number">60</span>)</span><br><span class="line">-------------------------------------------</span><br><span class="line"><span class="type">Time</span>: <span class="number">1539075288000</span> ms</span><br><span class="line">-------------------------------------------</span><br><span class="line">(<span class="number">4</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">0</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">6</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">8</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">2</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">1</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">3</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">7</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">9</span>,<span class="number">30</span>)</span><br><span class="line">(<span class="number">5</span>,<span class="number">30</span>)</span><br><span class="line">-------------------------------------------</span><br><span class="line"><span class="type">Time</span>: <span class="number">1539075292000</span> ms</span><br><span class="line">-------------------------------------------</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Kafka</title>
      <link href="/2022/12/08/Kafka/"/>
      <url>/2022/12/08/Kafka/</url>
      
        <content type="html"><![CDATA[<h1 id="Kafka"><a href="#Kafka" class="headerlink" title="Kafka"></a>Kafka</h1><p>kafka和flume都是日志系统。kafka是分布式消息中间件，自带存储，提供push和pull存取数据功能。flume分为agent（数据采集器）[source channel sink]。</p><p>(一).启动,停止</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-server-start.sh -daemon config/server.properties </span><br><span class="line">bin/kafka-server-stop.sh</span><br></pre></td></tr></table></figure><p>(二).<a href="https://blog.csdn.net/weixin_42854904/article/details/118424361?ops_request_misc=&request_id=&biz_id=102&utm_term=%E2%80%93bootstrap-server%20%E5%92%8C%20--zookeepe&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-118424361.142">两种方式</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.bootstrap-server master:9092 </span><br><span class="line">2.zookeeper master:2181 </span><br><span class="line"></span><br><span class="line">kafka 2.2版本之后才能用boot</span><br></pre></td></tr></table></figure><p>(三).创建topic</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/kafka-topic.sh --zookeeper master:2181/kafka --topic first --create --partitions --replication-factor 2</span><br></pre></td></tr></table></figure><p>这里，出现的问题是因为<a href="https://blog.csdn.net/u010003835/article/details/106956702?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522166804874416782414952137%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=166804874416782414952137&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-106956702-null-null.142%5Ev63%5Econtrol,201%5Ev3%5Econtrol_1,213%5Ev2%5Et3_control2&utm_term=ERROR%20org.apache.kafka.common.errors.InvalidReplicationFactorException:%20Replication%20factor:%203%20larger%20than%20available%20brokers:%201.&spm=1018.2226.3001.4187">Kafka</a> Broker 在 zookeeper 存储的路径并不是根目录，而是 <strong>&#x2F;kafka</strong> 路径</p><p>对于之前的指令，只需要增加 kafka 的config目录下的server.properties的存储路径后缀 ：zookeeper.connect&#x3D;master:2181,slave1:2181,slave2:2181 <strong>&#x2F;kafka</strong> 即可</p><p>(四).创建脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#! /bin/bash</span><br><span class="line"></span><br><span class="line">case $1 in </span><br><span class="line">&quot;start&quot;)&#123;</span><br><span class="line"></span><br><span class="line">for i in master slave1 slave2</span><br><span class="line">do</span><br><span class="line">echo &quot;***********kafka $i 启动 ***********&quot;</span><br><span class="line">ssh $i &quot;/usr/local/src/kafka/bin/kafka-server-start.sh -daemon /usr/local/src/kafka/config/server.properties&quot;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">&#125;;;</span><br><span class="line">&quot;stop&quot;)&#123;</span><br><span class="line"></span><br><span class="line">for i in master slave1 slave2</span><br><span class="line">do</span><br><span class="line">echo &quot;***********kafka $i 关闭 ***********&quot;</span><br><span class="line">ssh $i &quot;/usr/local/src/kafka/bin/kafka-server-stop.sh&quot;</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">&#125;;;</span><br><span class="line">esac</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">创建：kk.sh</span><br><span class="line">给权限：chmod 777 kk.sh</span><br></pre></td></tr></table></figure><p>(五).生产者，消费者</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.生产者：</span><br><span class="line">[root@master kafka]# bin/kafka-console-producer.sh --topic first --broker-list master:9092</span><br><span class="line"></span><br><span class="line">2.消费者：</span><br><span class="line">[root@slave1 kafka]# bin/kafka-console-consumer.sh --topic first --bootstrap-server master:9092</span><br><span class="line"></span><br><span class="line">从头消费：</span><br><span class="line">[root@slave2 kafka]# bin/kafka-console-consumer.sh --topic first --bootstrap-server master:9092 --from-beginning</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>(六).彻底删除</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.先删除kafka的logs rm-rf</span><br><span class="line">2.再删除zookeeper中的zkData目录下的Version2</span><br><span class="line">3.进入zkCli.sh查看是否只有zookeeper</span><br></pre></td></tr></table></figure><p>(七).对topic分析</p><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20221110163111738.png" alt="image-20221110163111738"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.indesx 索引机制</span><br><span class="line">.log 存放真实数据</span><br></pre></td></tr></table></figure><h1 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h1><h2 id="自定义消费者组"><a href="#自定义消费者组" class="headerlink" title="自定义消费者组"></a>自定义消费者组</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master config]# vim consumer.properties</span><br></pre></td></tr></table></figure><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20221111082616231.png" alt="image-20221111082616231"></p><h2 id="消费自定义消费者组"><a href="#消费自定义消费者组" class="headerlink" title="消费自定义消费者组"></a>消费自定义消费者组</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master kafka]# bin/kafka-console-consumer.sh --bootstrap-server master:9092 --topic bigdata --consumer.config config/consumer.properties </span><br></pre></td></tr></table></figure><h2 id="消费者API"><a href="#消费者API" class="headerlink" title="消费者API"></a>消费者API</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">自动提交</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">package</span> com.atguigu.consumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.consumer.ConsumerConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.consumer.ConsumerRecord;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.consumer.ConsumerRecords;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.consumer.KafkaConsumer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConsumer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.创建消费者信息</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.给配置信息赋值</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//连接集群</span></span><br><span class="line">        properties.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG,<span class="string">&quot;master:9092&quot;</span>);</span><br><span class="line">        <span class="comment">//开启自动提交</span></span><br><span class="line">        properties.put(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG,<span class="literal">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//延迟提交</span></span><br><span class="line"><span class="comment">//        properties.put(ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG,false);</span></span><br><span class="line">        <span class="comment">//自动提交的延时</span></span><br><span class="line">        properties.put(ConsumerConfig.AUTO_COMMIT_INTERVAL_MS_CONFIG,<span class="string">&quot;1000&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//Key,Value的序列化</span></span><br><span class="line">        properties.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG,<span class="string">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span>);</span><br><span class="line">        properties.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG,<span class="string">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//消费者组</span></span><br><span class="line">        properties.put(ConsumerConfig.GROUP_ID_CONFIG,<span class="string">&quot;bigdata&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//重置消费者的offset</span></span><br><span class="line"><span class="comment">//        properties.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG,&quot;earliest&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建消费者</span></span><br><span class="line">        KafkaConsumer&lt;String, String&gt; consumer = <span class="keyword">new</span> <span class="title class_">KafkaConsumer</span>&lt;&gt;(properties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//订阅主题</span></span><br><span class="line">        consumer.subscribe(Arrays.asList(<span class="string">&quot;first&quot;</span>,<span class="string">&quot;second&quot;</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="comment">//获取数据</span></span><br><span class="line">            ConsumerRecords&lt;String, String&gt; consumerRecords = consumer.poll(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//解析并打印consumerRecords</span></span><br><span class="line">            <span class="keyword">for</span> (ConsumerRecord&lt;String, String&gt; consumerRecord : consumerRecords) &#123;</span><br><span class="line"></span><br><span class="line">                System.out.println(consumerRecord.key() + <span class="string">&quot;--&quot;</span> + consumerRecord.value());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="生产者"><a href="#生产者" class="headerlink" title="生产者"></a>生产者</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@master kafka]# bin/kafka-console-producer.sh --topic clicks --broker-list master:9092</span><br></pre></td></tr></table></figure><h2 id="生产者API"><a href="#生产者API" class="headerlink" title="生产者API"></a>生产者API</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">普通API</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">package</span> com.atguigu.producer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.KafkaProducer;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.ProducerConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.ProducerRecord;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.创建Kafka生产者的配置信息</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.指定连接的Kafka级别</span></span><br><span class="line">        properties.put(<span class="string">&quot;bootstrap.servers&quot;</span>,<span class="string">&quot;master:9092&quot;</span>);</span><br><span class="line"><span class="comment">//        properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.ACK应答机制</span></span><br><span class="line">        properties.put(<span class="string">&quot;acks&quot;</span>,<span class="string">&quot;all&quot;</span>);</span><br><span class="line"><span class="comment">//        properties.put(ProducerConfig.ACKS_CONFIG,&quot;all&quot;);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.重试次数</span></span><br><span class="line">        properties.put(<span class="string">&quot;reties&quot;</span>,<span class="number">3</span>);</span><br><span class="line"><span class="comment">//        properties.put(ProducerConfig.RETRIES_CONFIG,3);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.批次大小</span></span><br><span class="line">        properties.put(<span class="string">&quot;batch.size&quot;</span>,<span class="string">&quot;16384&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//6.等待时间</span></span><br><span class="line">        properties.put(<span class="string">&quot;linger.ms&quot;</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//7.缓冲区大小</span></span><br><span class="line">        properties.put(<span class="string">&quot;buffer.memory&quot;</span>,<span class="number">33554432</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//8.Key,Value的序列化类</span></span><br><span class="line">        properties.put(<span class="string">&quot;key.serializer&quot;</span>,</span><br><span class="line">                <span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line"></span><br><span class="line">        properties.put(<span class="string">&quot;value.serializer&quot;</span>,</span><br><span class="line">                <span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//9.创建生产者对象</span></span><br><span class="line">        KafkaProducer&lt;String, String&gt; producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;String, String&gt;(properties);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//10.发送</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            producer.send(<span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;String, String&gt;(<span class="string">&quot;first&quot;</span>,<span class="string">&quot;beihai--&quot;</span> + i));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        Thread.sleep(100);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//11.关闭</span></span><br><span class="line">        producer.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">回调API</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> com.atguigu.producer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 回调函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CallBackMyProducer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.配置信息</span></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"></span><br><span class="line">        properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,<span class="string">&quot;master:9092&quot;</span>);</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            快捷搜索 shift + shift -&gt; StringSerializer -&gt; 复制全局路径</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG,</span><br><span class="line">                <span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line">        properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG,</span><br><span class="line">                <span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2.创建生产者对象</span></span><br><span class="line">        KafkaProducer&lt;String, String&gt; producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;String, String&gt;(properties);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        //模拟分区创建key</span></span><br><span class="line"><span class="comment">//        ArrayList&lt;String&gt; list = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">//        list.add(&quot;a&quot;);</span></span><br><span class="line"><span class="comment">//        list.add(&quot;b&quot;);</span></span><br><span class="line"><span class="comment">//        list.add(&quot;c&quot;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3.发送数据   这个如果用scala写是真的蛇皮</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            <span class="comment">//key没什么用，就是在缺分区的时候做哈希，按照key的哈希值模拟分区数</span></span><br><span class="line">            producer.send(<span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;String, String&gt;(<span class="string">&quot;aaa&quot;</span>, <span class="string">&quot;beihai&quot;</span>, <span class="string">&quot;beihai--&quot;</span> + i), <span class="keyword">new</span> <span class="title class_">Callback</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCompletion</span><span class="params">(RecordMetadata metadata, Exception exception)</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (exception == <span class="literal">null</span>) &#123;</span><br><span class="line">                        System.out.println(metadata.partition() + <span class="string">&quot;--&quot;</span> + metadata.offset());</span><br><span class="line">                    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                        exception.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//关闭资源</span></span><br><span class="line">        producer.close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="拦截器"><a href="#拦截器" class="headerlink" title="拦截器"></a>拦截器</h1><h2 id="时间拦截器"><a href="#时间拦截器" class="headerlink" title="时间拦截器"></a>时间拦截器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.ProducerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.ProducerRecord;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.RecordMetadata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TimeInterceptor</span> <span class="keyword">implements</span> <span class="title class_">ProducerInterceptor</span>&lt;String, String&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(Map&lt;String, ?&gt; configs)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProducerRecord&lt;String, String&gt; <span class="title function_">onSend</span><span class="params">(ProducerRecord&lt;String, String&gt; record)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//1.取出数据</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> record.value();</span><br><span class="line"></span><br><span class="line">     <span class="comment">/*</span></span><br><span class="line"><span class="comment">    时间戳拦截器，取出具体的数据，返回值的数据类型是关键，创建一个新的对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;String,String&gt;(record.topic(),record.partition()</span><br><span class="line">        , record.key(), System.currentTimeMillis()+<span class="string">&quot;,&quot;</span>+value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAcknowledgement</span><span class="params">(RecordMetadata metadata, Exception exception)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="数量拦截器"><a href="#数量拦截器" class="headerlink" title="数量拦截器"></a>数量拦截器</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.ProducerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.ProducerRecord;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.RecordMetadata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CounterInterceptor</span> <span class="keyword">implements</span> <span class="title class_">ProducerInterceptor</span>&lt;String,String&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> success;</span><br><span class="line">    <span class="type">int</span> error;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(Map&lt;String, ?&gt; configs)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ProducerRecord&lt;String, String&gt; <span class="title function_">onSend</span><span class="params">(ProducerRecord&lt;String, String&gt; record)</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> record;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onAcknowledgement</span><span class="params">(RecordMetadata metadata, Exception exception)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (metadata != <span class="literal">null</span>)&#123;</span><br><span class="line">            success++;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            error++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;success:&quot;</span> + success );</span><br><span class="line">        System.out.println(<span class="string">&quot;error:&quot;</span> + error );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="拦截器实例"><a href="#拦截器实例" class="headerlink" title="拦截器实例"></a>拦截器实例</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.interceptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.producer.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"></span><br><span class="line">        properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,<span class="string">&quot;master:9092&quot;</span>);</span><br><span class="line">        properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG,<span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line">        properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG,<span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//添加拦截器</span></span><br><span class="line">        ArrayList&lt;String&gt; interceptors = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        interceptors.add(<span class="string">&quot;com.atguigu.interceptor.TimeInterceptor&quot;</span>);</span><br><span class="line">        interceptors.add(<span class="string">&quot;com.atguigu.interceptor.CounterInterceptor&quot;</span>);</span><br><span class="line">        properties.put(ProducerConfig.INTERCEPTOR_CLASSES_CONFIG,interceptors);</span><br><span class="line"></span><br><span class="line">        KafkaProducer&lt;String, String&gt; producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;String, String&gt;(properties);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            producer.send(<span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;String, String&gt;(<span class="string">&quot;first&quot;</span>, <span class="number">0</span>,<span class="string">&quot;beihai&quot;</span>,<span class="string">&quot;beihai--&quot;</span> + i), <span class="keyword">new</span> <span class="title class_">Callback</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCompletion</span><span class="params">(RecordMetadata metadata, Exception exception)</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (exception == <span class="literal">null</span>) &#123;</span><br><span class="line">                        System.out.println(metadata.partition() + <span class="string">&quot;--&quot;</span> + metadata.offset());</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        exception.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        producer.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Kafka-flume对接"><a href="#Kafka-flume对接" class="headerlink" title="Kafka-flume对接"></a>Kafka-flume对接</h1><h2 id="1-简单案例利用netcat"><a href="#1-简单案例利用netcat" class="headerlink" title="1.简单案例利用netcat"></a>1.简单案例利用netcat</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">flume配置：</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1</span><br><span class="line">a1.channels = c1</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 44444</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a1.sinks.k1.type = org.apache.flume.sink.kafka.KafkaSink</span><br><span class="line">a1.sinks.k1.kafka.topic = mytopic</span><br><span class="line">a1.sinks.k1.kafka.bootstrap.servers = master:9092</span><br><span class="line">a1.sinks.k1.kafka.flumeBatchSize = 20</span><br><span class="line">a1.sinks.k1.kafka.producer.acks = 1</span><br><span class="line">a1.sinks.k1.kafka.producer.linger.ms = 1</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 1000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a1.sources.r1.channels = c1</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-使用多路复用模式"><a href="#2-使用多路复用模式" class="headerlink" title="2.使用多路复用模式"></a>2.使用多路复用模式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、在Master节点使用Flume采集实时数据生成器10050端口的socket数据，将数据存入到Kafka的Topic中（Topic名称为order，分区数为4），使用Kafka自带的消费者消费order（Topic）中的数据，将前2条数据的结果截图粘贴至对应报告中；</span><br><span class="line">2、采用多路复用模式，Flume接收数据注入kafka 的同时，将数据备份到HDFS目录/user/test/flumebackup下，将查看备份目录下的第一个文件的前2条数据的命令与结果截图粘贴至对应报告中。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">flume1</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a1.sources = r1</span><br><span class="line">a1.sinks = k1 k2</span><br><span class="line">a1.channels = c1 c2</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a1.sources.r1.type = netcat</span><br><span class="line">a1.sources.r1.bind = localhost</span><br><span class="line">a1.sources.r1.port = 10050</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a1.sinks.k1.type = avro</span><br><span class="line">a1.sinks.k1.hostname = localhost</span><br><span class="line">a1.sinks.k1.port = 7777</span><br><span class="line"></span><br><span class="line">a1.sinks.k2.type = avro</span><br><span class="line">a1.sinks.k2.hostname = localhost</span><br><span class="line">a1.sinks.k2.port = 8888</span><br><span class="line"></span><br><span class="line">#Channel selector</span><br><span class="line">a1.sources.r1.selector.type = replicating</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a1.channels.c1.type = memory</span><br><span class="line">a1.channels.c1.capacity = 10000</span><br><span class="line">a1.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">a1.channels.c2.type = memory</span><br><span class="line">a1.channels.c2.capacity = 10000</span><br><span class="line">a1.channels.c2.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a1.sources.r1.channels = c1 c2</span><br><span class="line">a1.sinks.k1.channel = c1</span><br><span class="line">a1.sinks.k2.channel = c2</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">kafka</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a2.sources = r1</span><br><span class="line">a2.sinks = k1</span><br><span class="line">a2.channels = c1</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a2.sources.r1.type = avro</span><br><span class="line">a2.sources.r1.bind = localhost</span><br><span class="line">a2.sources.r1.port = 7777</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a2.sinks.k1.type = org.apache.flume.sink.kafka.KafkaSink</span><br><span class="line">a2.sinks,k1.kafka.topic = order</span><br><span class="line">a2.sinks.k1.kafka.bootstrap.servers = master:9092</span><br><span class="line">a2.sinks.k1.kafka.flumeBatchSize = 20</span><br><span class="line">a2.sinks.k1.kafka.producer.acks = 1</span><br><span class="line">a2.sinks.k1.kafka.producer.linger.ms = 1</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a2.channels.c1.type = memory</span><br><span class="line">a2.channels.c1.capacity = 1000</span><br><span class="line">a2.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a2.sources.r1.channels = c1</span><br><span class="line">a2.sinks.k1.channel = c1</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">HDFS</span><br><span class="line"></span><br><span class="line">#Name</span><br><span class="line">a3.sources = r1</span><br><span class="line">a3.sinks = k1</span><br><span class="line">a3.channels = c1</span><br><span class="line"></span><br><span class="line">#Source</span><br><span class="line">a3.sources.r1.type =avro</span><br><span class="line">a3.sources.r1.bind = localhost</span><br><span class="line">a3.sources.r1.port = 8888</span><br><span class="line"></span><br><span class="line">#Sink</span><br><span class="line">a3.sinks.k1.type = hdfs</span><br><span class="line">a3.sinks.k1.hdfs.path = hdfs://master:9000/user/test/flumebackup</span><br><span class="line">a3.sinks.k1.hdfs.filePrefix = beihai-</span><br><span class="line">a3.sinks.k1.hdfs.round = true</span><br><span class="line">a3.sinks.k1.hdfs.roundValue = 1</span><br><span class="line">a3.sinks.k1.hdfs.roundUnit = hour</span><br><span class="line">a3.sinks.k1.hdfs.useLocalTimeStamp = true</span><br><span class="line">a3.sinks.k1.hdfs.batchSize = 100</span><br><span class="line">a3.sinks.k1.hdfs.fileType = DataStream</span><br><span class="line">a3.sinks.k1.hdfs.rollInterval = 60</span><br><span class="line">a3.sinks.k1.hdfs.rollSize = 134217700</span><br><span class="line">a3.sinks.k1.hdfs.rollCount = 0</span><br><span class="line"></span><br><span class="line">#Channel</span><br><span class="line">a3.channels.c1.type = memory</span><br><span class="line">a3.channels.c1.capacity = 10000</span><br><span class="line">a3.channels.c1.transactionCapacity = 100</span><br><span class="line"></span><br><span class="line">#Bind</span><br><span class="line">a3.sources.r1.channels = c1</span><br><span class="line">a3.sinks.k1.channel = c1</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@master ~]# hadoop fs -cat /user/test/flumebackup/logs-.1668222346787 |head -2</span><br><span class="line">156</span><br><span class="line">5322</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>sqoop</title>
      <link href="/2022/12/08/Sqoop/"/>
      <url>/2022/12/08/Sqoop/</url>
      
        <content type="html"><![CDATA[<h1 id="Sqoop"><a href="#Sqoop" class="headerlink" title="Sqoop"></a>Sqoop</h1><p>sqoop是在Hadoop生态体系和关系型数据库之间传送数据的一种工具<br>工作机制：<br>    将导入或导出的命令翻译成mapreduce程序</p><p><img src="C:\Users\beihai\AppData\Roaming\Typora\typora-user-images\image-20221020153227605.png" alt="image-20221020153227605"></p><h2 id="Sqoop验证启动"><a href="#Sqoop验证启动" class="headerlink" title="Sqoop验证启动"></a>Sqoop验证启动</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/sqoop list-databases --connect jdbc:mysql://localhost:3306/ --username root --password 000000</span><br></pre></td></tr></table></figure><h1 id="Sqoop全量数据导入"><a href="#Sqoop全量数据导入" class="headerlink" title="Sqoop全量数据导入"></a>Sqoop全量数据导入</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">全量数据：所有数据</span><br></pre></td></tr></table></figure><h2 id="Sqoop全量导入Mysql表数据到HDFS"><a href="#Sqoop全量导入Mysql表数据到HDFS" class="headerlink" title="Sqoop全量导入Mysql表数据到HDFS"></a>Sqoop全量导入Mysql表数据到HDFS</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">下面的命令用于从 MySQL 数据库服务器中的 emp 表导入 HDFS。</span><br><span class="line">bin/sqoop import \</span><br><span class="line">--connect jdbc:mysql://Master:3306/yyh \</span><br><span class="line">--username root \</span><br><span class="line">--password 000000 \</span><br><span class="line">--delete-target-dir \</span><br><span class="line">--target-dir /sqoopresult \</span><br><span class="line">--fields-terminated-by &#x27;\t&#x27; \</span><br><span class="line">--table beihaibei --m 1</span><br><span class="line"></span><br><span class="line">bin/sqoop import \</span><br><span class="line">--connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">--username root \</span><br><span class="line">--password 000000 \</span><br><span class="line">--target-dir /sqoopresult2 \</span><br><span class="line">--fields-terminated-by &#x27;\t&#x27; \</span><br><span class="line">--table emp --m 1</span><br><span class="line"></span><br><span class="line">bin/sqoop import \</span><br><span class="line">--connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">--username root \</span><br><span class="line">--password 000000 \</span><br><span class="line">--target-dir /sqoopresult3 \</span><br><span class="line">--fields-terminated-by &#x27;\t&#x27; \</span><br><span class="line">--split-by id \</span><br><span class="line">--table emp </span><br><span class="line">--m 2</span><br><span class="line">--driver com.mysql.jdbc.Driver  </span><br><span class="line"></span><br><span class="line">这里driver必须加上</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">这里的sqoop import是固定搭配</span><br><span class="line"></span><br><span class="line">Master是主节点，如果本地可以写localhost，  userdb是mysql所选数据库</span><br><span class="line"></span><br><span class="line">username/password 是mysql的账号和密码</span><br><span class="line"></span><br><span class="line">delete-target-dir 它的意思是查看hdfs上是否有所创的文件夹，如果有就删去重新覆盖</span><br><span class="line"></span><br><span class="line">target-dir /sqoopresult 是在hdfs上创一文件夹sqoopresult，将emp表导入hdfs</span><br><span class="line"></span><br><span class="line">emp 是mysql数据库的表名</span><br><span class="line"></span><br><span class="line">--m 1 是运行map操作的一个进程</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">--columns</span><br></pre></td></tr></table></figure><h2 id="利用Hive2方式连接"><a href="#利用Hive2方式连接" class="headerlink" title="利用Hive2方式连接"></a>利用Hive2方式连接</h2><h3 id="1-开启服务"><a href="#1-开启服务" class="headerlink" title="1.开启服务"></a>1.开启服务</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop bin]# nohup hive --service metastore &amp;</span><br><span class="line">[root@hadoop bin]# nohup hive --service hiveserver2 &amp;</span><br></pre></td></tr></table></figure><h3 id="2-建立连接"><a href="#2-建立连接" class="headerlink" title="2.建立连接"></a>2.建立连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@slave2 bin]# beeline</span><br><span class="line">Beeline version 1.2.1.spark2 by Apache Hive</span><br><span class="line">beeline&gt; ! connect jdbc:hive2://master:10000</span><br><span class="line">Connecting to jdbc:hive2://master:10000</span><br><span class="line">Enter username for jdbc:hive2://master:10000: root</span><br><span class="line">Enter password for jdbc:hive2://master:10000: </span><br><span class="line">.</span><br><span class="line">.</span><br><span class="line">0: jdbc:hive2://master:10000&gt;</span><br></pre></td></tr></table></figure><h3 id=""><a href="#" class="headerlink" title=""></a></h3><h2 id="Sqoop全量导入Mysql表数据到Hive"><a href="#Sqoop全量导入Mysql表数据到Hive" class="headerlink" title="Sqoop全量导入Mysql表数据到Hive"></a>Sqoop全量导入Mysql表数据到Hive</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">方式一：复制表结构</span><br><span class="line">1.将关系型数据的表结构复制到hive中</span><br><span class="line">bin/sqoop create-hive-table \</span><br><span class="line">--connect jdbc:mysql://master:3306/shtd_store \</span><br><span class="line">--table ChangeRecord \</span><br><span class="line">--username root \</span><br><span class="line">--password 000000 \</span><br><span class="line">--hive-table &#x27;dwd.fact_change_record&#x27;</span><br><span class="line"></span><br><span class="line">2.从关系数据库导入文件到hive中</span><br><span class="line">bin/sqoop import \</span><br><span class="line">--connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">--username root \</span><br><span class="line">--password hadoop \</span><br><span class="line">--table emp_add \</span><br><span class="line">--hive-table test.emp_add1 \</span><br><span class="line">--hive-import \</span><br><span class="line">--m 1</span><br><span class="line"></span><br><span class="line">查看表结构：desc emp_add1</span><br><span class="line">查看表：select * from emp_add1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">方式二：直接导入数据到hive中 包括表结构和数据</span><br><span class="line">bin/sqoop import \</span><br><span class="line">--connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">--username root \</span><br><span class="line">--password 000000 \</span><br><span class="line">--table emp_add \</span><br><span class="line">--hive-import \</span><br><span class="line">--m 1 \</span><br><span class="line">--hive-database sqoop;</span><br></pre></td></tr></table></figure><p>导入遇到的错误解决：</p><p>1.报错：FAILED: SemanticException [Error 10072]: Database does not exist: liantong0826</p><p>解决方法：复制hive&#x2F;conf下的hive-site.xml到sqoop工作目录的conf下</p><p>2.时区问题</p><p>3.SSH</p><p>4.hive的环境变量</p><h2 id="Where查询过滤"><a href="#Where查询过滤" class="headerlink" title="Where查询过滤"></a>Where查询过滤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@master bin]# sqoop import \</span><br><span class="line">&gt; --connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">&gt; --username root \</span><br><span class="line">&gt; --password 000000 \</span><br><span class="line">&gt; --table emp_add \</span><br><span class="line">&gt; --where &quot;city = &#x27;sec-bad&#x27; &quot; \</span><br><span class="line">&gt; --target-dir /sqoopresult02 \</span><br><span class="line">&gt; --m 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">输出结果：</span><br><span class="line">[root@master bin]# hdfs dfs -cat /sqoopresult02/part-m-00000</span><br><span class="line">1202,108I,aoc,sec-bad</span><br><span class="line">1204,78B,old city,sec-bad</span><br><span class="line">1205,720X,hitec,sec-bad</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="Query查询"><a href="#Query查询" class="headerlink" title="Query查询"></a>Query查询</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@master bin]# sqoop import \</span><br><span class="line">&gt; --connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">&gt; --username root \</span><br><span class="line">&gt; --password 000000 \</span><br><span class="line">&gt; --target-dir /querysqoop01 \</span><br><span class="line">&gt; --query &#x27;select id,name,deg from emp WHERE  id&gt;1203 and $CONDITIONS&#x27; \</span><br><span class="line">&gt; --split-by id \</span><br><span class="line">&gt; --fields-terminated-by &#x27;\001&#x27; \</span><br><span class="line">&gt; --m 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">必要点：</span><br><span class="line">1.使用query sql 语句来查询不用加参数--table</span><br><span class="line">2.必须添加where条件</span><br><span class="line">3.where条件之后必须带一个$CONDITIONS 字符串</span><br><span class="line">4.query sql 语句必须用单引号&#x27;&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="增量数据导入"><a href="#增量数据导入" class="headerlink" title="增量数据导入"></a>增量数据导入</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">增量导入是仅导入新添加的表中的行的技术。 </span><br><span class="line"></span><br><span class="line">--check-column (col) 用来指定一些列，这些列在增量导入时用来检查这些数据是否作为增量数据 进行导入，和关系型数据库中的自增字段及时间戳类似。 注意:这些被指定的列的类型不能使任意字符类型，如 char、varchar 等类 型都是不可以的，同时-- check-column 可以去指定多个列。 </span><br><span class="line">--incremental (mode) append：追加，比如对大于 last-value 指定的值之后的记录进行追加导入。 lastmodified：最后的修改时间，追加 last-value 指定的日期之后的记录 </span><br><span class="line"></span><br><span class="line">--last-value (value)  指定自从上次导入后列的最大值（大于该指定的值），也可以自己设定某一值</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Append模式增量导入"><a href="#Append模式增量导入" class="headerlink" title="Append模式增量导入"></a>Append模式增量导入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">字段增量</span><br><span class="line">[root@master bin]# sqoop import \</span><br><span class="line">&gt; --connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">&gt; --username root \</span><br><span class="line">&gt; --password 000000 \</span><br><span class="line">&gt; --table emp --m 1 \</span><br><span class="line">&gt; --target-dir /appendsult \</span><br><span class="line">&gt; --incremental append \</span><br><span class="line">&gt; --check-column id \</span><br><span class="line">&gt; --last-value 1205</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Lastmodified模式增量导入-append-merge-key"><a href="#Lastmodified模式增量导入-append-merge-key" class="headerlink" title="Lastmodified模式增量导入(append+merge-key)"></a>Lastmodified模式增量导入(append+merge-key)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">时间戳增量</span><br><span class="line">create table customertest(id int,name varchar(20),last_mod timestamp default current_timestamp on update current_timestamp);</span><br><span class="line"></span><br><span class="line">insert into customertest(id,name) values(1,&#x27;neil&#x27;);</span><br><span class="line">insert into customertest(id,name) values(2,&#x27;jack&#x27;);</span><br><span class="line">insert into customertest(id,name) values(3,&#x27;martin&#x27;);</span><br><span class="line">insert into customertest(id,name) values(4,&#x27;tony&#x27;);</span><br><span class="line">insert into customertest(id,name) values(5,&#x27;eric&#x27;);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">再次插入一条数据进入customertest表</span><br><span class="line">insert into customertest(id,name) values(6,&#x27;james&#x27;);</span><br><span class="line"></span><br><span class="line">使用incremental的方式进行增量的导入:</span><br><span class="line">bin/sqoop import \</span><br><span class="line">--connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">--username root \</span><br><span class="line">--password 000000 \</span><br><span class="line">--table customertest \</span><br><span class="line">--target-dir /lastmodifiedresult \</span><br><span class="line">--check-column last_mod \</span><br><span class="line">--incremental lastmodified \</span><br><span class="line">--last-value &quot;2022-10-23 16:05:39&quot; \</span><br><span class="line">--m 1 \</span><br><span class="line">--append</span><br><span class="line"></span><br><span class="line">此处已经会导入我们最后插入的一条记录,但是我们却发现此处插入了2条数据，这是为什么呢？ </span><br><span class="line">这是因为采用lastmodified模式去处理增量时，会将大于等于last-value值的数据当做增量插入</span><br><span class="line"></span><br><span class="line">注意: </span><br><span class="line">使用lastmodified模式进行增量处理要指定增量数据是以append模式(附加)还是merge-key(合并)模式添加 </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">merge-by的模式</span><br><span class="line"></span><br><span class="line">update customertest set name = &#x27;Neil&#x27; where id = 1;</span><br><span class="line">更新之后，这条数据的时间戳会更新为我们更新数据时的系统时间.</span><br><span class="line">执行如下指令，把id字段作为merge-key:</span><br><span class="line"></span><br><span class="line">bin/sqoop import \</span><br><span class="line">--connect jdbc:mysql://master:3306/userdb \</span><br><span class="line">--username root \</span><br><span class="line">--password 000000 \</span><br><span class="line">--table customertest \</span><br><span class="line">--target-dir /lastmodifiedresult \</span><br><span class="line">--check-column last_mod \</span><br><span class="line">--incremental lastmodified \</span><br><span class="line">--last-value &quot;2022-10-23 16:05:39&quot; \</span><br><span class="line">--m 1 \</span><br><span class="line">--merge-key id </span><br></pre></td></tr></table></figure><h1 id="Sqoop导出"><a href="#Sqoop导出" class="headerlink" title="Sqoop导出"></a>Sqoop导出</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">从Hadoop生态体系导出到RDBMS数据库</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">将数据从 Hadoop 生态体系导出到 RDBMS 数据库导出前，目标表必须存在于</span><br><span class="line">目标数据库中。</span><br><span class="line">export 有三种模式：</span><br><span class="line">默认操作是从将文件中的数据使用 INSERT 语句插入到表中。</span><br><span class="line">更新模式：Sqoop 将生成 UPDATE 替换数据库中现有记录的语句。</span><br><span class="line">调用模式：Sqoop 将为每条记录创建一个存储过程调用。</span><br></pre></td></tr></table></figure><p>默认模式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sqoop export \</span><br><span class="line">--connect jdbc:mysql://node-1:3306/userdb \</span><br><span class="line">--username root \</span><br><span class="line">--password hadoop \</span><br><span class="line">--table employee1 \</span><br><span class="line">--export-dir /emp_data/</span><br><span class="line"></span><br><span class="line">注意导出到mysql数据库时候需要先建表，然后导出</span><br></pre></td></tr></table></figure><p>默认配置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">相关配置参数</span><br><span class="line">--input-fields-terminated-by &#x27;\t&#x27;</span><br><span class="line">指定文件中的分隔符</span><br><span class="line">--columns </span><br><span class="line">选择列并控制它们的排序。当导出数据文件和目标表字段列顺序完全一</span><br><span class="line">致的时候可以不写。否则以逗号为间隔选择和排列各个列。没有被包含在–</span><br><span class="line">columns 后面列名或字段要么具备默认值，要么就允许插入空值。否则数据</span><br><span class="line">库会拒绝接受 sqoop 导出的数据，导致 Sqoop 作业失败</span><br><span class="line">--export-dir 导出目录，在执行导出的时候，必须指定这个参数，同时需要具</span><br><span class="line">备--table 或--call 参数两者之一，--table 是指的导出数据库当中对应的表，</span><br><span class="line">--call 是指的某个存储过程。</span><br><span class="line">--input-null-string --input-null-non-string</span><br><span class="line">如果没有指定第一个参数，对于字符串类型的列来说，“NULL”这个字符</span><br><span class="line">串就回被翻译成空值，如果没有使用第二个参数，无论是“NULL”字符串还</span><br><span class="line">是说空字符串也好，对于非字符串类型的字段来说，这两个类型的空串都会</span><br><span class="line">被翻译成空值。比如：</span><br><span class="line">--input-null-string &quot;\\N&quot; --input-null-non-string &quot;\\N&quot;</span><br></pre></td></tr></table></figure><p>[Apache Sqoop.pdf](file:&#x2F;&#x2F;&#x2F;E:&#x2F;大数据资料&#x2F;黑马程序员&#x2F;Apache Sqoop资料&#x2F;讲义sqoop&#x2F;Apache Sqoop.pdf)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn logs -applicationId application_1666744533757_0006</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 大数据 </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
